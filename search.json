[{"path":"https://yhata86.github.io/fluxfixer/LICENSE.html","id":null,"dir":"","previous_headings":"","what":"MIT License","title":"MIT License","text":"Copyright (c) 2026 Yoshiaki Hata Permission hereby granted, free charge, person obtaining copy software associated documentation files (“Software”), deal Software without restriction, including without limitation rights use, copy, modify, merge, publish, distribute, sublicense, /sell copies Software, permit persons Software furnished , subject following conditions: copyright notice permission notice shall included copies substantial portions Software. SOFTWARE PROVIDED “”, WITHOUT WARRANTY KIND, EXPRESS IMPLIED, INCLUDING LIMITED WARRANTIES MERCHANTABILITY, FITNESS PARTICULAR PURPOSE NONINFRINGEMENT. EVENT SHALL AUTHORS COPYRIGHT HOLDERS LIABLE CLAIM, DAMAGES LIABILITY, WHETHER ACTION CONTRACT, TORT OTHERWISE, ARISING , CONNECTION SOFTWARE USE DEALINGS SOFTWARE.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"introduction","dir":"Articles","previous_headings":"","what":"Introduction","title":"fluxfixer","text":"fluxfixer provides sophisticated protocol post-processing raw time series, can applied thermal dissipation sap flow data also noisy time series, using classic statistical machine-learning methods. vignette demonstrates use main functions showing actual post-processing sap flow data observed Malaysia.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"installation","dir":"Articles","previous_headings":"","what":"Installation","title":"fluxfixer","text":"can install latest version fluxfixer CRAN : , can install development version GitHub : , load attach package.","code":"install.packages(\"fluxfixer\") # install.packages(\"remotes\") remotes::install_github(\"yhata86/fluxfixer\") library(fluxfixer)"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"workflow","dir":"Articles","previous_headings":"","what":"Workflow","title":"fluxfixer","text":"Now can use various functions package. Please check demonstration , consisting three sections. first section shows prepare input data suitable whole post-processing protocol. can learn variables needed processes want conduct. second section explains way apply processes input data automatically. understand arguments set correctly based input data required processes. third section demonstrates apply process step--step input data. helpful satisfied automatic process result modify details process.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"data-preparation","dir":"Articles","previous_headings":"Workflow","what":"Data preparation","title":"fluxfixer","text":"begin , need prepare input data frame. preparation depends type time series want post-process.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"for-thermal-dissipation-sap-flow-time-series","dir":"Articles","previous_headings":"Workflow > Data preparation","what":"For thermal dissipation sap flow time series","title":"fluxfixer","text":"variables listed table mandatory method determine zero-flow conditions (SP: Successive predawn method; PD: Daily predawn method; MW: Moving window method; DR: Double regression method; ED: Environmental dependent method). ΔT\\Delta T temperature difference sap flow probes. can select multiple methods automatic processing. details variable column. Timestamp: timestamp class POSIXct POSIXt, indicating timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. ΔT\\Delta T: numeric value temperature difference sap flow probes. units ∘C^\\circ \\mathrm{C}. acceptable include missing values, label representing missing value must unique -9999. Global solar radiation: numeric value indicating incident short-wave radiation. units W m-2. choose PD, MW, DR, ED methods, time series must included gap-filled previously. methods use define daytime, can use PPFD (photosynthetic photon flux density) another variable strong correlation global solar radiation. cases, must modify threshold value daytime definition specified argument thres_radi run_fluxfixer() calc_dtmax(). case radiative time series, package offers calc_sw_in_toa() function estimates global solar radiation top atmosphere specific location. can add time series input data frame determine zero-flow conditions. See details ?calc_sw_in_toa(). Air temperature: numeric value units ∘C^\\circ \\mathrm{C}. select ED method, time series must included gap-filled previously. Vapor pressure deficit (VPD): numeric value representing difference saturated water vapor pressure actual partial water vapor pressure atmosphere. units hPa. select ED method, time series must included gap-filled previously. even select ED method, VPD recommended included input data frame construct powerful random forest model outlier detection gap-filling processes, VPD typically controls opening plant stomata. case, fill gaps time series previously. variables: Even select SP method, need add many drivers influence sap flow dynamics possible input data frame construct powerful random forest model outlier detection gap-filling processes. example, want post-process sap flow data observed deciduous forest, recommended include time series representing forest leaf amount, LAI (leaf area index). can also include columns unrelated post-processing, sure indicate variables used random forest construction execute run_fluxfixer() specifying vctr_colname_feature.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"for-time-series-unrelated-to-thermal-dissipation-sap-flow","dir":"Articles","previous_headings":"Workflow > Data preparation","what":"For time series unrelated to thermal dissipation sap flow","title":"fluxfixer","text":"case, input data frame required columns . Timestamp: timestamp class POSIXct POSIXt, indicating timings end measurement local time. interval allowed, timestamps must equally spaced arranged chronologically. Target variable: numeric value variable want post-process. acceptable include missing values, label representing missing value must unique -9999. variables: need add many drivers influence targeted variable dynamics possible input data frame construct powerful random forest model outlier detection gap-filling processes. can also include columns unrelated post-processing, sure indicate variables used random forest construction execute run_fluxfixer() specifying vctr_colname_feature.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"automatic-execution-of-all-processes","dir":"Articles","previous_headings":"Workflow","what":"Automatic execution of all processes","title":"fluxfixer","text":"section shows use function run_fluxfixer() post-processing half-hourly ΔT\\Delta T time series observed Malaysia Sep. 2012 Aug. 2013. Even case want execute run_fluxfixer() non-sap-flow time series, process similar. need set argument, skip_sapflow_calc, TRUE (default FALSE), function skips processes specific sap flow data, zero-flow conditions estimation sap flux density calculation. Let’s start loading sample data frame. data frame contains columns . time: Timestamp measurement end timing local time dt: ΔT\\Delta T time series (∘C^\\circ \\mathrm{C}) p: Precipitation (mm) sw_in: Global solar radiation (W m-2) ta: Air temperature (∘C^\\circ \\mathrm{C}) vpd: Vapor pressure deficit (hPa) ws: Horizontal wind speed (m s-1) swc: Soil water content (m^3 m-3)} can check details data frame ?data(\"dt_noisy\") necessary. target column dt, check time series visually first.  , can check time series specific period code . visualization, come ideas post-processing. short-term signal drift May 2013. short-term drift correction needed. high-frequency noise contamination throughout measurement period. high-frequency noise filtering required. Long-term gradual signal trend exists. Detrending needed preventing underestimation sap flux density. Signal damping, means gradual decrease signal standard deviation, occur. signal damping correction required. sap flow sensor replaced May 2013, according information data provider. measurement sub-period set. Now, able set appropriate arguments run_fluxfixer() execute . Note , default arguments, function conduct short-term drift correction, noise filtering, detrending, signal damping correction. Also, SP method applied default estimate zero-flow conditions. result data frame contains columns . time: timestamp input timestamp specified colname_time. raw: input ΔT\\Delta T time series specified colname_target. processed: post-processed ΔT\\Delta T time series qc: quality-control (QC) flag time series indicating history modifications data point. See details ?run_fluxfixer dtmax_sp: ΔTmax\\Delta T_\\mathrm{max} (maximum temperature difference sap flow probes zero-flow conditions) time series calculated SP method. fd_sp: FdF_\\mathrm{d} (sap flux density) time series using ΔTmax\\Delta T_\\mathrm{max} calculated SP method. can confirm whether function post-processed raw time series appropriately drawing graph.  blue orange points represent raw processed ΔT\\Delta T time series. function able remove error values outliers, correct short-term drift, fill missing values, detrending. can also check time series specific period code . want know happened automated process, let’s move following section. able learn raw data modified process, use run_fluxfixer() function related functions flexibly setting various arguments appropriately.","code":"## Load sample data data(\"dt_noisy\") ## Just for the visualization # install.packages(\"ggplot2) library(ggplot2)  ## Set the period you want to check time_head <- as.POSIXct(\"2012/09/01 00:30\", tz = \"Etc/GMT-8\") time_tail <- as.POSIXct(\"2013/09/01 00:00\", tz = \"Etc/GMT-8\")  dt_noisy %>%    dplyr::mutate(dplyr::across(tidyselect::where(is.numeric),                               ~dplyr::na_if(., -9999))) %>%    ggplot2::ggplot()+   scale_x_datetime(limits = c(time_head, time_tail))+   geom_point(aes(time, dt), col = \"royalblue\") ## Specify the period of the short-term drift time_drft_head <- as.POSIXct(\"2013/05/14 13:30\", tz = \"Etc/GMT-8\") time_drft_tail <- as.POSIXct(\"2013/05/17 15:00\", tz = \"Etc/GMT-8\")  ## Specify the sensor replacement timing time_prd_tail <- as.POSIXct(\"2013/05/14 13:00\", tz = \"Etc/GMT-8\")  ## Run all processes automatically result <-   run_fluxfixer(df = dt_noisy,                 colname_time = \"time\",                 colname_target = \"dt\",                 vctr_time_drft_head = time_drft_head,                 vctr_time_drft_tail = time_drft_tail,                 vctr_time_prd_tail = time_prd_tail,                 detrend = TRUE) ## Set the period you want to check time_head <- as.POSIXct(\"2012/09/01 00:30\", tz = \"Etc/GMT-8\") time_tail <- as.POSIXct(\"2013/09/01 00:00\", tz = \"Etc/GMT-8\")  result %>%    dplyr::mutate(dplyr::across(tidyselect::where(is.numeric),                               ~dplyr::na_if(., -9999))) %>%    ggplot2::ggplot()+   scale_x_datetime(limits = c(time_head, time_tail))+   geom_point(aes(time, raw), col = \"royalblue\", alpha = 0.01)+   geom_point(aes(time, processed), col = \"orange\", alpha = 0.1)"},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"data-input","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process","what":"Data Input","title":"fluxfixer","text":"jumped section directly, please load sample data first. Let’s explore functions deeply comprise automated function, run_fluxfixer().","code":"## Load sample data data(\"dt_noisy\")"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"anomaly-correction","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process","what":"Anomaly correction","title":"fluxfixer","text":"begin , remove anomalies correct time series. process divided three procedures: absolute limit test, short-term drift correction, high-frequency noise removal.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"absolute-limit-test","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process > Anomaly correction","what":"Absolute limit test","title":"fluxfixer","text":"check_absolute_limits() removes --range values setting lower upper limits. default, function removes values less 3 50, assuming input vector ΔT\\Delta T time series. can set threshold values according reasonable range input time series specifying thres_al_min thres_al_max arguments. got new column, dt_al, data frame. column indicates ΔT\\Delta T time series --range value removal.","code":"## Conduct the absolute limit test df_all <-   dt_noisy %>%    dplyr::mutate(dt_al = check_absolute_limits(vctr_target = dt))"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"short-term-drift-correction-optional","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process > Anomaly correction","what":"Short-term drift correction (optional)","title":"fluxfixer","text":"modify_short_drift() corrects sudden changes average time series short period (hours days) specified vctr_time_drft_head vctr_time_drft_tail. Multiple short-term drifts can corrected using function. procedure uses reference period, defined number days specified n_day_ref occurrence anomaly. , anomalous time series standardized 5th 95th percentile values anomalous reference (non-anomalous) time series match period. percentile values used instead maximum minimum values ensure robustness possible outliers original reference time series. indicated previous section, input time series short-term signal drift May 2013. , need conduct optional process. column dt_sdc represents ΔT\\Delta T time series correction.","code":"## Specify the period of the short-term drift time_drft_head <- as.POSIXct(\"2013/05/14 13:30\", tz = \"Etc/GMT-8\") time_drft_tail <- as.POSIXct(\"2013/05/17 15:00\", tz = \"Etc/GMT-8\")  ## Conduct the short-term drift correction df_all <-   df_all %>%    dplyr::mutate(dt_sdc = modify_short_drift(vctr_time = time,                                             vctr_target = dt_al,                                             vctr_time_drft_head = time_drft_head,                                             vctr_time_drft_tail = time_drft_tail))"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"high-frequency-noise-removal-optional","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process > Anomaly correction","what":"High-frequency noise removal (optional)","title":"fluxfixer","text":"filter_highfreq_noise() filters time series specific period convolving Gaussian window, removing high-frequency noise. period filtered can specified vctr_time_noise. Also, can modify shape Gaussian window wndw_size_noise inv_sigma_noise arguments. sample data, high-frequency noise contamination. , conduct optional process.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"outlier-removal","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process","what":"Outlier removal","title":"fluxfixer","text":"next step remove outliers target time series. process consists two procedures: Z-score outlier removal random forest outlier removal.","code":""},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"z-score-outlier-removal","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process > Outlier removal","what":"Z-score outlier removal","title":"fluxfixer","text":"remove_zscore_outlier() detects removes outliers converting original time series Z-score time series using moving window. Z-score calculated subtracting average original value dividing standard deviation. input time series standardized using moving window, data values converted Z-scores. step, width moving window, specified wndw_size_z, set 15 days default, centered target time point, standardization performed individually time point time series. upper lower limits Z-score, specified thres_z (default: ±5), set, data points outside range removed outliers. outliers removed, Z-score returned original value using original mean standard deviation time series, standardization performed using moving window remove additional outliers. procedures repeated either outliers removed maximum number iterations, specified n_calc_max (default: 10), reached. Users can define sub-periods across entire time series using vctr_time_prd_tail, Z-score conversion performed sub-period separately. separated conversion useful input time series suddenly changes nature, sensor replacement. sample data process, sensor replacement occurred May 2013. , recommended set sub-period. column z_cleaned represents standardized ΔT\\Delta T time series Z-score outlier removal. cases, sap flow measurements, input ΔT\\Delta T time series may yield signal attenuated short period, example, rainfall continues days, causing moving window mean (standard deviation) increase (decrease). cases, standardization cause Z-score time series immediately rainfall unnaturally distorted, hindering construction random forest model. modify_z TRUE, outlier removal, function modifies Z-score time series periods moving window average upward peak, moving window standard deviation downward peak simultaneously. See details ?remove_zscore_outlier.","code":"## Specify the sensor replacement timing time_prd_tail <- as.POSIXct(\"2013/05/14 13:00\", tz = \"Etc/GMT-8\")  ## Conduct the Z-score outlier removal df_z <-   remove_zscore_outlier(vctr_time = df_all$time,                         vctr_target = df_all$dt_sdc,                         vctr_time_prd_tail = time_prd_tail)  df_all <-   df_z %>%    dplyr::select(z_cleaned, avg_cleaned, sd_cleaned) %>%    dplyr::bind_cols(df_all, .)"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"random-forest-outlier-removal","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process > Outlier removal","what":"Random forest outlier removal","title":"fluxfixer","text":"remove_rf_outlier() detects removes outliers random forest model whose hyperparameters calibrated using grid search approach --bag evaluation. random forest model constructed targeted time series remove outliers. time series assumed stationary, standardized time series suitable process. can input feature input data frame, --bag evaluation used determine hyperparameters. evaluation applied training dataset separated entire input data. reduce computational cost, hyperparameter used default grid search number candidate features (vctr_m_try). reduce risk learning noise, training data sampling ratio, specified vctr_subsample_outlier, set 0.1 default. determining optimal hyperparameters, used construct optimal random forest model. Output values obtained 500 (default; specified n_tree) trees, first quartile (Q1), third quartile (Q3), interquartile range (IQR) output values time point calculated. targeted value less Q1−1.5IQR\\mathrm{Q_1 − 1.5IQR} Q3+1.5IQR\\mathrm{Q_3 + 1.5IQR} (default), data point identified outlier removed. coefficient 1.5 can changed coef_iqr. sample data frame contains time series environmental factors, including precipitation (p), global solar radiation (sw_in), air temperature (ta), vapor pressure deficit (vpd), horizontal wind speed (ws), soil water content (swc). Using drivers, can construct precise random forest model. Note specify explanatory variable names vctr_colname_feature, columns excluding column specified colname_label used construction. column z_rf df_all data frame represents standardized ΔT\\Delta T time series random forest outlier removal. want remove outliers remaining output time series visual inspection, consider using remove_manually(). However, manual outlier removal recommended due high subjectivity. Additionally, want conduct signal detrending damping correction following processes, need define reference values average standard deviation. Using cleaned time series two outlier removal processes, calc_ref_stats() determines reference values calculating median statistical values first several days sub-period. See details ?calc_ref_stats. sample data process, apply detrending. , calculate reference statistics now. Note calculation applied target time series original units, need convert cleaned Z-score time series inputting calc_ref_stats(). vctr_stats_ref two components: first one reference average, second one reference standard deviation.","code":"## Conduct the random forest outlier removal df_rf <-   remove_rf_outlier(df = df_all,                     colname_label = \"z_cleaned\",                     vctr_colname_feature = c(\"p\", \"sw_in\", \"ta\", \"vpd\", \"ws\", \"swc\"))  df_all <-   df_all %>%    dplyr::mutate(z_rf = df_rf$stats$cleaned) ## Calculate the reference values of average and standard deviation vctr_stats_ref <-         data.frame(z_target = df_all$z_rf,                    avg_target = df_z$avg_cleaned,                    sd_target = df_z$sd_cleaned) %>%         dplyr::mutate(target = ifelse(z_target != -9999 &                                         avg_target != -9999 &                                         sd_target != -9999,                                       z_target * sd_target + avg_target,                                       -9999)) %>%         dplyr::pull(target) %>%         calc_ref_stats(vctr_time = df_all$time,                        vctr_target = .,                        vctr_time_prd_tail = time_prd_tail)"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"gap-filling","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process","what":"Gap-filling","title":"fluxfixer","text":"fill_gaps() replaces missing values target time series values estimated random forest model. hyperparameter calibration process random forest outlier removal. determining optimal hyperparameters, used construct optimal random forest model. Predicted time series equal average 500 (default; specified n_tree) tree outputs time point. input targeted value missing, predicted value used imputation. column z_gf df_all data frame represents gap-filled standardized ΔT\\Delta T time series.","code":"## Fill all the missing values by the random forest model df_gf <-   fill_gaps(df = df_all,             colname_label = \"z_rf\",             vctr_colname_feature = c(\"p\", \"sw_in\", \"ta\", \"vpd\", \"ws\", \"swc\"))  df_all <-   df_all %>%    dplyr::mutate(z_gf = df_gf$stats$gapfilled)"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"time-series-retrieval","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process","what":"Time series retrieval","title":"fluxfixer","text":"retrieve_ts() converts standardized Z-score time series time series original units. retrieval performed multiplying Z-score standard deviation adding average. average standard deviation time series converting original time series Z-score time series, original values original average standard deviation retrieved. reference values average /standard deviation used, output time series detrended /applied signal damping correction. sample data process, detrending needed. , set detrend TRUE, input reference average calculated calc_ref_stats() avg_ref, let correct_damping remain FALSE. column dt_processed represents quality-controlled ΔT\\Delta T time series, output time series run_fluxfixer() previous section. Well done! following parts, learn processes specific thermal dissipation sap flow data.","code":"## Retrieve the time series in its original units df_all <-   df_all %>%   dplyr::mutate(dt_processed = retrieve_ts(vctr_target_z = df_all$z_gf,                                            vctr_target_sd = df_all$sd_cleaned,                                            detrend = TRUE,                                            avg_ref = vctr_stats_ref[1]))"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"zero-flow-conditions-determination","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process","what":"Zero-flow conditions determination","title":"fluxfixer","text":"calc_dtmax() provides multiple ΔTmax\\Delta T_\\mathrm{max} time series estimated different methods : successive predawn (SP) method defines ΔTmax\\Delta T_\\mathrm{max} day maximum ΔT\\Delta T within 24-hour period begins 5:00 .m. (default; just daybreak temperate zones specified thres_hour_sp). words, day starts predawn, midnight, maximum value period assumed ΔTmax\\Delta T_\\mathrm{max}. method advantage able calculate ΔTmax\\Delta T_\\mathrm{max} quickly minimizing effect nocturnal transpiration ΔTmax\\Delta T_\\mathrm{max} estimation. daily predawn (PD) method defines ΔTmax\\Delta T_\\mathrm{max} day maximum ΔT\\Delta T midnight morning (8:00 .m. local time, specified thres_hour_pd) global solar radiation threshold value, specified thres_radi. See details Peters et al. (2018). moving window (MW) method selects maximum value ΔTmax\\Delta T_\\mathrm{max}, estimated PD method, using moving window eleven-day length (default; specified wndw_size_dtmax). selected ΔTmax\\Delta T_\\mathrm{max} considered final ΔTmax\\Delta T_\\mathrm{max}. See details Peters et al. (2018). double regression (DR) method first calculates moving window mean value ΔTmax\\Delta T_\\mathrm{max}, estimated PD method, eleven-day length (default; specified wndw_size_dtmax). ΔTmax\\Delta T_\\mathrm{max} lower mean omitted, moving window mean recalculated final ΔTmax\\Delta T_\\mathrm{max}. See details Peters et al. (2018). environmental dependent (ED) method filters ΔTmax\\Delta T_\\mathrm{max}, estimated PD method, using environmental conditions plants let sap flow nearly zero. stable ΔT\\Delta T, low coefficient variation, low air temperature vapor pressure deficit two-hour period, characterizes zero-flow conditions. threshold values can changed thres_cv, thres_ta, thres_vpd arguments. See details Oishi et al. (2016) Peters et al. (2018). filtering, daily ΔTmax\\Delta T_\\mathrm{max} interpolated necessary. default, calc_dtmax() outputs ΔTmax\\Delta T_\\mathrm{max} time series SP method. can select combination methods specifying method, method = c(\"sp\", \"pd\"). Make sure indicate vectors meteorological variables required selected methods vctr_radi, vctr_ta, vctr_vpd arguments. See table “Data preparation” section check variables needed method. columns dtmax_sp dtmax_pd represent ΔTmax\\Delta T_\\mathrm{max} time series calculated SP PD method, respectively.","code":"## Calculate dTmax by the SP and PD methods df_dtmax <-   calc_dtmax(vctr_time = df_all$time,              vctr_dt = df_all$dt_processed,              vctr_radi = df_all$sw_in,              method = c(\"sp\", \"pd\"))  df_all <-   df_dtmax %>%    dplyr::select(dtmax_sp, dtmax_pd) %>%    dplyr::bind_cols(df_all, .)"},{"path":"https://yhata86.github.io/fluxfixer/articles/fluxfixer.html","id":"sap-flux-density-calculation","dir":"Articles","previous_headings":"Workflow > Step-by-step executions of each process","what":"Sap flux density calculation","title":"fluxfixer","text":"final step. calc_fd() calculates FdF_\\mathrm{d} (sap flux density) time series, including heartwood correction. FdF_\\mathrm{d} estimated using power-type function introduced Granier (1985, 1987). First, dimensionless index K obtained ΔT\\Delta T ΔTmax\\Delta T_\\mathrm{max}. Second, K raised power beta multiplied alpha, obtaining FdF_\\mathrm{d}. sapwood width shorter probe insertion length, ΔT\\Delta T can overestimated, resulting underestimation FdF_\\mathrm{d}. Therefore, heartwood correction required correct ΔT\\Delta T. Optionally, calculating FdF_\\mathrm{d}, ΔT\\Delta T can replaced corrected ΔT\\Delta T specifying ratio probe length sapwood width. correction assumes ΔT\\Delta T measured part probe inserted heartwood always ΔTmax\\Delta T_\\mathrm{max}. See details Clearwater et al. (1999). sample data process, need heartwood correction. , let do_heartwood_correction remain FALSE. columns fd_sp fd_pd represent calculated FdF_\\mathrm{d} time series using ΔTmax\\Delta T_\\mathrm{max} estimated SP PD method, respectively. Congratulations! Now can use functions run_fluxfixer() appropriately flexibly. hope fluxfixer make data quality control tasks less painful. questions, please check function’s help page first, feel free contact .","code":"## Calculate Fd using the dTmax estimated by the SP and PD methods df_all <-   df_all %>%    dplyr::mutate(fd_sp = calc_fd(vctr_dt = dt_processed,                                 vctr_dtmax = dtmax_sp),                 fd_pd = calc_fd(vctr_dt = dt_processed,                                 vctr_dtmax = dtmax_pd))"},{"path":"https://yhata86.github.io/fluxfixer/authors.html","id":null,"dir":"","previous_headings":"","what":"Authors","title":"Authors and Citation","text":"Yoshiaki Hata. Author, maintainer, copyright holder.","code":""},{"path":"https://yhata86.github.io/fluxfixer/authors.html","id":"citation","dir":"","previous_headings":"","what":"Citation","title":"Authors and Citation","text":"Hata Y (2026). fluxfixer: Advanced Framework Sap Flow Data Post-Process. R package version 1.0.0, https://github.com/yhata86/fluxfixer.","code":"@Manual{,   title = {fluxfixer: Advanced Framework for Sap Flow Data Post-Process},   author = {Yoshiaki Hata},   year = {2026},   note = {R package version 1.0.0},   url = {https://github.com/yhata86/fluxfixer}, }"},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/index.html","id":"overview","dir":"","previous_headings":"","what":"Overview","title":"Advanced Framework for Sap Flow Data Post-Process","text":"goal fluxfixer automatically post-process sap flow data measured thermal dissipation method. Notably, package can detect outliers fill data gaps using machine learning method takes environmental variables input. quality control protocols can also applied types raw time series many artifacts. fluxfixer provides various functions can detect aberrant structural changes time series dynamics, correct time series, calculate sap flux density different methods deriving zero-flow conditions. Basically, can conduct whole process executing one function, run_fluxfixer(). Optionally, can apply process step--step using functions : check_absolute_limits() eliminates physically unreasonable values. modify_short_drift() corrects short-term signal drifts. filter_highfreq_noise() filters high-frequency noise time series. remove_zscore_outlier() detects removes outliers Z-score transformation. remove_rf_outlier() detects removes outliers random forest model. fill_gaps() imputes missing values time series random forest model. retrieve_ts() converts standardized Z-score time series time series original units conducting detrending signal damping correction. sap flow data processing: calc_dtmax() estimates reference values observed temperature difference probes zero-flow conditions (dTmax) multiple methods. calc_fd() calculates sap flux density, considering heartwood correction. can learn use browseVignettes(\"fluxfixer\").","code":""},{"path":"https://yhata86.github.io/fluxfixer/index.html","id":"installation","dir":"","previous_headings":"","what":"Installation","title":"Advanced Framework for Sap Flow Data Post-Process","text":"can install latest version fluxfixer CRAN : , can install development version GitHub :","code":"install.packages(\"fluxfixer\") # install.packages(\"remotes\") remotes::install_github(\"yhata86/fluxfixer\")"},{"path":"https://yhata86.github.io/fluxfixer/index.html","id":"example","dir":"","previous_headings":"","what":"Example","title":"Advanced Framework for Sap Flow Data Post-Process","text":"Assume conducted sap flow measurement Malaysia Sep. 2012 Aug. 2013, obtained half-hourly time series :  ΔT\\Delta T temperature difference sap flow probes, used calculating sap flux density (FdF_\\mathrm{d}). may feel upset since time series : many values near zero due power supply shortages short-term drift May, just sensor replacement long-term trend daily maximum value sensor degradation worry. fluxfixer can rescue time series output continuous, stationary time series. begin , prepare dataset containing raw ΔT\\Delta T environmental variables, specify timestamps events. , thing need execute run_fluxfixer() : can derive data frame containing post-processed time series .  output data frame also contains FdF_\\mathrm{d} time series, ultimately want. example post-processed half-hourly FdF_\\mathrm{d} time series Feb. 2013.  shaded area represents gap-filled period random forest model. can see imputed time series reproduced diurnal cycle non-imputed time series successfully.","code":"## Load sample data data(\"dt_noisy\")  ## Specify the period of the short-term drift time_drft_head <- as.POSIXct(\"2013/05/14 13:30\", tz = \"Etc/GMT-8\") time_drft_tail <- as.POSIXct(\"2013/05/17 15:00\", tz = \"Etc/GMT-8\")  ## Specify the sensor replacement timing time_prd_tail <- as.POSIXct(\"2013/05/14 13:00\", tz = \"Etc/GMT-8\") ## Run all processes automatically result <-   run_fluxfixer(df = dt_noisy,                 colname_time = \"time\",                 colname_target = \"dt\",                 vctr_time_drft_head = time_drft_head,                 vctr_time_drft_tail = time_drft_tail,                 vctr_time_prd_tail = time_prd_tail,                 detrend = TRUE)"},{"path":"https://yhata86.github.io/fluxfixer/index.html","id":"license","dir":"","previous_headings":"","what":"License","title":"Advanced Framework for Sap Flow Data Post-Process","text":"package open-source released MIT License. See LICENSE file details.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by various methods — calc_dtmax","title":"Calculate dTmax by various methods — calc_dtmax","text":"`calc_dtmax()` calculates time series dTmax (maximum  temperature difference sap flow probes zero-flow conditions)  using multiple methods.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by various methods — calc_dtmax","text":"","code":"calc_dtmax(   vctr_time,   vctr_dt,   vctr_radi = NULL,   vctr_ta = NULL,   vctr_vpd = NULL,   method = c(\"sp\"),   thres_hour_sp = 5,   thres_radi = 100,   thres_ta = 1,   thres_vpd = 1,   thres_cv = 0.005,   thres_hour_pd = 8,   min_n_wndw_dtmax = 3,   wndw_size_dtmax = 11,   output_daily = FALSE )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by various methods — calc_dtmax","text":"vctr_time timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. vctr_dt vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. vctr_radi vector global solar radiation similar radiative variable time series. Default `NULL`, vector must provided `method` includes `pd`, `mw`, `dr`, `ed`. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_radi`. vctr_ta vector air temperature (degrees Celsius) time series. Default `NULL`, vector must provided `method` includes `ed`. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_ta`. vctr_vpd vector vapor pressure deficit (VPD, hPa) time series. Default `NULL`, vector must provided `method` includes `ed`. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_vpd`. method vector characters indicating dTmax estimation methods. \"sp\", \"pd\", \"mw\", \"dr\", \"ed\" represent successive predawn, daily predawn, moving window, double regression, environmental dependent method, respectively. Default `c(\"sp\")`. thres_hour_sp integer 0 23. threshold hour day defines start predawn local time (default 5). thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_ta threshold value air temperature define predawn. Default 1.0 (degrees Celsius). dTmax, estimated PD method, air temperature values threshold, selected candidate final dTmax. unit threshold must match input air temperature time series. thres_vpd threshold value VPD define predawn. Default 1.0 (hPa). dTmax, estimated PD method, VPD values threshold, selected candidate final dTmax. unit threshold must match input VPD time series. thres_cv threshold value coefficient variation (CV) define predawn. Default 0.005. dTmax, estimated PD method, CV values threshold, selected candidate final dTmax. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. wndw_size_dtmax positive integer indicating window size (days) determining moving window maximum values dTmax. Default 11 (days). output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate dTmax by various methods — calc_dtmax","text":"data frame columns : * first column, `time`, gives timestamp measurements.  `output_daily` `FALSE` (default), column input  timestamp, `vctr_time`. `output_daily` `TRUE`, timestamp daily  steps returned. * second column, `dt`, gives input dT time series. `output_daily`  `TRUE`, dT returned daily steps. `output_daily` `FALSE`  (default), column output. * columns, prefix \"dtmax_\", provide dTmax  calculated methods specified `method`. last two letters  column name represent name dTmax estimation method. \"sp\",  \"pd\", \"mw\", \"dr\", \"ed\" represent successive predawn, daily predawn,  moving window, double regression, environmental dependent method,  respectively. `output_daily` `FALSE` (default), column  time step input timestamp. `output_daily` `TRUE`,  dTmax returned daily steps.\"","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate dTmax by various methods — calc_dtmax","text":"function provides multiple dTmax time series estimated  different methods : * successive predawn (SP) method defines dTmax day   maximum dT (temperature difference sap flow probes) within   24-hour period begins 5:00 .m. (default; just daybreak   temperate zones). words, day starts predawn, midnight,   maximum value period assumed dTmax. method   advantage able calculate dTmax quickly   minimizing effect nocturnal transpiration dTmax estimation. * daily predawn (PD) method defines dTmax day maximum   dT midnight morning (8:00 .m. local time)   global solar radiation threshold value (100 W m-2). See   details Peters et al. (2018; New Phytologist). * moving window (MW) method selects maximum value dTmax,   estimated daily predawn method, using moving window   eleven-day length. selected dTmax considered final dTmax.   See details Peters et al. (2018; New Phytologist). * double regression (DR) method first calculates moving window mean   value dTmax, estimated daily predawn method, eleven-day   length. dTmax lower mean omitted,   moving window mean recalculated final dTmax. See details   Peters et al. (2018; New Phytologist). * environmental dependent (ED) method filters dTmax, estimated   daily predawn method, using environmental conditions plants   let sap flow nearly zero. stable dT, low coefficient   variation, low air temperature vapor pressure deficit   two-hour period, characterizes zero-flow conditions. See   details Oishi et al. (2016; SoftwareX) Peters et al. (2018; New   Phytologist). filtering, daily dTmax interpolated   necessary.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate dTmax by various methods — calc_dtmax","text":"","code":"## Load data data(dt_gf) time <- dt_gf$time[1:480] dt <- dt_gf$dt[1:480] radi <- dt_gf$sw_in[1:480] ta <- dt_gf$ta[1:480] vpd <- dt_gf$vpd[1:480]  ## Calculate dTmax from gap-filled dT time series result <-  calc_dtmax(vctr_time = time, vctr_dt = dt, vctr_radi = radi, vctr_ta = ta,             vctr_vpd = vpd, method = c(\"sp\", \"pd\", \"mw\", \"dr\", \"ed\"),             thres_vpd = 6.0) #> Zero-flow condition estimation started #> --- dTmax calculation by the SP method started #> --- dTmax calculation by the SP method finished #> --- dTmax calculation by the PD and ED methods started #>    |                                                                               |                                                                      |   0%   |                                                                               |========                                                              |  11%   |                                                                               |================                                                      |  22%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================                                       |  44%   |                                                                               |=======================================                               |  56%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================                |  78%   |                                                                               |==============================================================        |  89%   |                                                                               |======================================================================| 100% #>  #> --- dTmax calculation by the PD and ED methods finished #> --- dTmax calculation by the MW and DR methods started #>    |                                                                               |                                                                      |   0%   |                                                                               |========                                                              |  11%   |                                                                               |================                                                      |  22%   |                                                                               |=======================                                               |  33%   |                                                                               |===============================                                       |  44%   |                                                                               |=======================================                               |  56%   |                                                                               |===============================================                       |  67%   |                                                                               |======================================================                |  78%   |                                                                               |==============================================================        |  89%   |                                                                               |======================================================================| 100% #>  #> --- dTmax calculation by the MW and DR methods finished #> --- dTmax time series aggregation started #> --- dTmax time series aggregation finished #> Zero-flow condition estimation finished"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_dr.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by the double regression method — calc_dtmax_dr","title":"Calculate dTmax by the double regression method — calc_dtmax_dr","text":"`calc_dtmax_dr()` calculates time series dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) using double regression method.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_dr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by the double regression method — calc_dtmax_dr","text":"","code":"calc_dtmax_dr(   vctr_time_daily = NULL,   vctr_dtmax_pd = NULL,   wndw_size_dtmax = 11,   min_n_wndw_dtmax = 3,   output_daily = FALSE,   vctr_time = NULL,   vctr_dt = NULL,   vctr_radi = NULL,   thres_radi = 100,   thres_hour_pd = 8 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_dr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by the double regression method — calc_dtmax_dr","text":"vctr_time_daily timestamp vector class POSIXct POSIXt daily steps. vector indicates start end dates measurement, assumed output `calc_dtmax_pd()` function. timestamps must equally spaced arranged chronologically. argument `NULL` (default), `vctr_time`, `vctr_dt`, `vctr_radi` must provided conduct daily predawn method previously. vctr_dtmax_pd vector dTmax estimated daily predawn method daily steps. vector assumed output `calc_dtmax_pd()` function. length vector must match `vctr_time_daily`. argument `NULL` (default), `vctr_time`, `vctr_dt`, `vctr_radi` must provided conduct daily predawn method previously. wndw_size_dtmax positive integer indicating window size (days) determining moving window maximum values dTmax. Default 11 (days). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`. vctr_time valid `vctr_dtmax_pd` `NULL`. timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. Default `NULL`. vctr_dt valid `vctr_dtmax_pd` `NULL`. vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match `vctr_time`. Missing values must gap-filled previously. Default `NULL`. vctr_radi valid `vctr_dtmax_pd` `NULL`. vector global solar radiation similar radiative variable time series. length vector must match `vctr_time`. Missing values must gap-filled previously. unit time series must match `thres_radi`. Default `NULL`. thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8).","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_dr.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate dTmax by the double regression method — calc_dtmax_dr","text":"data frame columns : * first column, `time`, gives timestamp measurements.  `output_daily` `FALSE` (default), column input  timestamp, `vctr_time`. `output_daily` `TRUE`, timestamp daily  steps returned. * second column, `dt`, gives input dT (temperature difference  sap flow probes, degrees Celsius) time series. `output_daily`  `TRUE`, dT returned daily steps. `output_daily` `FALSE`  (default), column output. * third column, `dtmax_dr`, gives estimated dTmax double  regression method. `output_daily` `FALSE` (default), column  time step input timestamp. `output_daily` `TRUE`,  dTmax returned daily steps.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_dr.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate dTmax by the double regression method — calc_dtmax_dr","text":"double regression method one methods determining  dTmax. method first calculates moving window mean value dTmax,  estimated daily predawn method, eleven-day length. dTmax  lower mean omitted, moving window mean  recalculated final dTmax. See details Peters et al. (2018;  New Phytologist).","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_dr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate dTmax by the double regression method — calc_dtmax_dr","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_ed.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by the environmental dependent method — calc_dtmax_ed","title":"Calculate dTmax by the environmental dependent method — calc_dtmax_ed","text":"`calc_dtmax_ed()` calculates time series dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) using environmental dependent method.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_ed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by the environmental dependent method — calc_dtmax_ed","text":"","code":"calc_dtmax_ed(   vctr_time,   vctr_dt,   vctr_radi,   vctr_ta,   vctr_vpd,   thres_radi = 100,   thres_ta = 1,   thres_vpd = 1,   thres_cv = 0.005,   thres_hour_pd = 8,   min_n_wndw_dtmax = 3,   output_daily = FALSE )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_ed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by the environmental dependent method — calc_dtmax_ed","text":"vctr_time timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. vctr_dt vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. vctr_radi vector global solar radiation similar radiative variable time series. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_radi`. vctr_ta vector air temperature (degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_ta`. vctr_vpd vector vapor pressure deficit (VPD, hPa) time series. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_vpd`. thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_ta threshold value air temperature define predawn. Default 1.0 (degrees Celsius). dTmax, estimated PD method, air temperature values threshold, selected candidate final dTmax. unit threshold must match input air temperature time series. thres_vpd threshold value VPD define predawn. Default 1.0 (hPa). dTmax, estimated PD method, VPD values threshold, selected candidate final dTmax. unit threshold must match input VPD time series. thres_cv threshold value coefficient variation (CV) define predawn. Default 0.005. dTmax, estimated PD method, CV values threshold, selected candidate final dTmax. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_ed.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate dTmax by the environmental dependent method — calc_dtmax_ed","text":"data frame columns : * first column, `time`, gives timestamp measurements.  `output_daily` `FALSE` (default), column input  timestamp, `vctr_time`. `output_daily` `TRUE`, timestamp daily  steps returned. * second column, `dt`, gives input dT (temperature difference  sap flow probes, degrees Celsius) time series. `output_daily`  `TRUE`, dT returned daily steps. `output_daily` `FALSE`  (default), column output. * third column, `dtmax_ed`, gives estimated dTmax  environmental dependent method. `output_daily` `FALSE` (default),  column time step input timestamp.  `output_daily` `TRUE`, dTmax returned daily steps.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_ed.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate dTmax by the environmental dependent method — calc_dtmax_ed","text":"environmental dependent method one methods  determining dTmax. method filters dTmax, estimated daily  predawn method, using environmental conditions plants let  sap flow nearly zero. stable dT, low coefficient variation,  low air temperature vapor pressure deficit two-hour period,  characterizes zero-flow conditions. See details Oishi et al.  (2016; SoftwareX) Peters et al. (2018; New Phytologist).  filtering, daily dTmax interpolated necessary.","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_ed.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate dTmax by the environmental dependent method — calc_dtmax_ed","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by the moving window method — calc_dtmax_mw","title":"Calculate dTmax by the moving window method — calc_dtmax_mw","text":"`calc_dtmax_mw()` calculates time series dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) using moving window method.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by the moving window method — calc_dtmax_mw","text":"","code":"calc_dtmax_mw(   vctr_time_daily = NULL,   vctr_dtmax_pd = NULL,   wndw_size_dtmax = 11,   min_n_wndw_dtmax = 3,   output_daily = FALSE,   vctr_time = NULL,   vctr_dt = NULL,   vctr_radi = NULL,   thres_radi = 100,   thres_hour_pd = 8 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by the moving window method — calc_dtmax_mw","text":"vctr_time_daily timestamp vector class POSIXct POSIXt daily steps. vector indicates start end dates measurement, assumed output `calc_dtmax_pd()` function. timestamps must equally spaced arranged chronologically. argument `NULL` (default), `vctr_time`, `vctr_dt`, `vctr_radi` must provided conduct daily predawn method previously. vctr_dtmax_pd vector dTmax estimated daily predawn method daily steps. vector assumed output `calc_dtmax_pd()` function. length vector must match `vctr_time_daily`. argument `NULL` (default), `vctr_time`, `vctr_dt`, `vctr_radi` must provided conduct daily predawn method previously. wndw_size_dtmax positive integer indicating window size (days) determining moving window maximum values dTmax. Default 11 (days). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`. vctr_time valid `vctr_dtmax_pd` `NULL`. timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. Default `NULL`. vctr_dt valid `vctr_dtmax_pd` `NULL`. vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match `vctr_time`. Missing values must gap-filled previously. Default `NULL`. vctr_radi valid `vctr_dtmax_pd` `NULL`. vector global solar radiation similar radiative variable time series. length vector must match `vctr_time`. Missing values must gap-filled previously. unit time series must match `thres_radi`. Default `NULL`. thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8).","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate dTmax by the moving window method — calc_dtmax_mw","text":"data frame columns : * first column, `time`, gives timestamp measurements.  `output_daily` `FALSE` (default), column input  timestamp, `vctr_time`. `output_daily` `TRUE`, timestamp daily  steps returned. * second column, `dt`, gives input dT (temperature difference  sap flow probes, degrees Celsius) time series. `output_daily`  `TRUE`, dT returned daily steps. `output_daily` `FALSE`  (default), column output. * third column, `dtmax_mw`, gives estimated dTmax moving  window method. `output_daily` `FALSE` (default), column  time step input timestamp. `output_daily` `TRUE`,  dTmax returned daily steps.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate dTmax by the moving window method — calc_dtmax_mw","text":"moving window method one methods determining  dTmax. method selects maximum value dTmax, estimated  daily predawn method, using moving window eleven-day length.  selected dTmax considered final dTmax. See details  Peters et al. (2018; New Phytologist).","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate dTmax by the moving window method — calc_dtmax_mw","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw_dr.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by the moving window and double regression methods — calc_dtmax_mw_dr","title":"Calculate dTmax by the moving window and double regression methods — calc_dtmax_mw_dr","text":"`calc_dtmax_mw_dr()` calculates time series dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) using moving window double regression methods.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw_dr.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by the moving window and double regression methods — calc_dtmax_mw_dr","text":"","code":"calc_dtmax_mw_dr(   vctr_time_daily = NULL,   vctr_dtmax_pd = NULL,   wndw_size_dtmax = 11,   min_n_wndw_dtmax = 3,   output_daily = FALSE,   vctr_time = NULL,   vctr_dt = NULL,   vctr_radi = NULL,   thres_radi = 100,   thres_hour_pd = 8 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw_dr.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by the moving window and double regression methods — calc_dtmax_mw_dr","text":"vctr_time_daily timestamp vector class POSIXct POSIXt daily steps. vector indicates start end dates measurement, assumed output `calc_dtmax_pd()` function. timestamps must equally spaced arranged chronologically. argument `NULL` (default), `vctr_time`, `vctr_dt`, `vctr_radi` must provided conduct daily predawn method previously. vctr_dtmax_pd vector dTmax estimated daily predawn method daily steps. vector assumed output `calc_dtmax_pd()` function. length vector must match `vctr_time_daily`. argument `NULL` (default), `vctr_time`, `vctr_dt`, `vctr_radi` must provided conduct daily predawn method previously. wndw_size_dtmax positive integer indicating window size (days) determining moving window maximum values dTmax. Default 11 (days). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`. vctr_time valid `vctr_dtmax_pd` `NULL`. timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. Default `NULL`. vctr_dt valid `vctr_dtmax_pd` `NULL`. vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match `vctr_time`. Missing values must gap-filled previously. Default `NULL`. vctr_radi valid `vctr_dtmax_pd` `NULL`. vector global solar radiation similar radiative variable time series. length vector must match `vctr_time`. Missing values must gap-filled previously. unit time series must match `thres_radi`. Default `NULL`. thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8).","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_mw_dr.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate dTmax by the moving window and double regression methods — calc_dtmax_mw_dr","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by the daily predawn method — calc_dtmax_pd","title":"Calculate dTmax by the daily predawn method — calc_dtmax_pd","text":"`calc_dtmax_pd()` calculates time series dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) using daily predawn method.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by the daily predawn method — calc_dtmax_pd","text":"","code":"calc_dtmax_pd(   vctr_time,   vctr_dt,   vctr_radi,   thres_radi = 100,   thres_hour_pd = 8,   min_n_wndw_dtmax = 3,   output_daily = FALSE )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by the daily predawn method — calc_dtmax_pd","text":"vctr_time timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. vctr_dt vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. vctr_radi vector global solar radiation similar radiative variable time series. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_radi`. thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate dTmax by the daily predawn method — calc_dtmax_pd","text":"data frame columns : * first column, `time`, gives timestamp measurements.  `output_daily` `FALSE` (default), column input  timestamp, `vctr_time`. `output_daily` `TRUE`, timestamp daily  steps returned. * second column, `dt`, gives input dT (temperature difference  sap flow probes, degrees Celsius) time series. `output_daily`  `TRUE`, dT returned daily steps. `output_daily` `FALSE`  (default), column output. * third column, `dtmax_pd`, gives estimated dTmax daily  predawn method. `output_daily` `FALSE` (default), column  time step input timestamp. `output_daily` `TRUE`,  dTmax returned daily steps.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate dTmax by the daily predawn method — calc_dtmax_pd","text":"daily predawn method one methods determining  dTmax. method defines dTmax day maximum dT ( temperature difference sap flow probes) midnight  morning (8:00 .m. local time) global solar radiation  threshold value (100 W m-2). See details Peters et al. (2018;  New Phytologist).","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate dTmax by the daily predawn method — calc_dtmax_pd","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd_ed.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by the daily predawn and environmental dependent methods — calc_dtmax_pd_ed","title":"Calculate dTmax by the daily predawn and environmental dependent methods — calc_dtmax_pd_ed","text":"`calc_dtmax_pd_ed()` calculates time series dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) using daily predawn environmental dependent methods.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd_ed.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by the daily predawn and environmental dependent methods — calc_dtmax_pd_ed","text":"","code":"calc_dtmax_pd_ed(   vctr_time,   vctr_dt,   vctr_radi,   vctr_ta,   vctr_vpd,   thres_radi = 100,   thres_ta = 1,   thres_vpd = 1,   thres_cv = 0.005,   thres_hour_pd = 8,   min_n_wndw_dtmax = 3,   output_daily = FALSE )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd_ed.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by the daily predawn and environmental dependent methods — calc_dtmax_pd_ed","text":"vctr_time timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. vctr_dt vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. vctr_radi vector global solar radiation similar radiative variable time series. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_radi`. vctr_ta vector air temperature (degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_ta`. vctr_vpd vector vapor pressure deficit (VPD, hPa) time series. length vector must match timestamp vector. Missing values must gap-filled previously. unit time series must match `thres_vpd`. thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_ta threshold value air temperature define predawn. Default 1.0 (degrees Celsius). dTmax, estimated PD method, air temperature values threshold, selected candidate final dTmax. unit threshold must match input air temperature time series. thres_vpd threshold value VPD define predawn. Default 1.0 (hPa). dTmax, estimated PD method, VPD values threshold, selected candidate final dTmax. unit threshold must match input VPD time series. thres_cv threshold value coefficient variation (CV) define predawn. Default 0.005. dTmax, estimated PD method, CV values threshold, selected candidate final dTmax. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_pd_ed.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate dTmax by the daily predawn and environmental dependent methods — calc_dtmax_pd_ed","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_sp.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate dTmax by the successive predawn method — calc_dtmax_sp","title":"Calculate dTmax by the successive predawn method — calc_dtmax_sp","text":"`calc_dtmax_sp()` calculates time series dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) using successive predawn method.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_sp.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate dTmax by the successive predawn method — calc_dtmax_sp","text":"","code":"calc_dtmax_sp(vctr_time, vctr_dt, thres_hour_sp = 5, output_daily = FALSE)"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_sp.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate dTmax by the successive predawn method — calc_dtmax_sp","text":"vctr_time timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. vctr_dt vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. thres_hour_sp integer 0 23. threshold hour day defines start predawn local time (default 5). output_daily boolean. `TRUE`, returns dTmax time series daily steps; else, returns dTmax original time steps. Default `FALSE`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_sp.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate dTmax by the successive predawn method — calc_dtmax_sp","text":"data frame columns : * first column, `time`, gives timestamp measurements.  `output_daily` `FALSE` (default), column input  timestamp, `vctr_time`. `output_daily` `TRUE`, timestamp daily  steps returned. * second column, `dt`, gives input dT (temperature difference  sap flow probes, degrees Celsius) time series. `output_daily`  `TRUE`, dT returned daily steps. `output_daily` `FALSE`  (default), column output. * third column, `dtmax_sp`, gives estimated dTmax successive  predawn method. `output_daily` `FALSE` (default), column  time step input timestamp. `output_daily` `TRUE`,  dTmax returned daily steps.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_sp.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate dTmax by the successive predawn method — calc_dtmax_sp","text":"successive predawn method one methods determining  maximum temperature difference sap flow probes zero-flow  conditions. method defines dTmax day maximum dT ( temperature difference sap flow probes) within 24-hour period  begins 5:00 .m. (default; just daybreak temperate  zones). words, day starts predawn, midnight,  maximum value period assumed dTmax. method  advantage able calculate dTmax quickly minimizing  effect nocturnal transpiration dTmax estimation.","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_dtmax_sp.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate dTmax by the successive predawn method — calc_dtmax_sp","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_fd.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate sap flux density time series — calc_fd","title":"Calculate sap flux density time series — calc_fd","text":"`calc_fd()` calculates Fd (sap flux density) time series  power-type function, including heartwood correction.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_fd.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate sap flux density time series — calc_fd","text":"","code":"calc_fd(   vctr_dt,   vctr_dtmax,   alpha = 1.19 * 10^(-4),   beta = 1.231,   do_heartwood_correction = FALSE,   ratio_conductive = NULL )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_fd.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate sap flux density time series — calc_fd","text":"vctr_dt vector dT (temperature difference sap flow probes, degrees Celsius) time series. length vector must match timestamp vector. Missing values must gap-filled previously. vctr_dtmax vector dTmax (maximum temperature difference sap flow probes zero-flow conditions, degrees Celsius) time series. length vector must match `vctr_dt`. Missing values must gap-filled previously. alpha positive value representing multiplier equation calculate Fd. Default 1.19 * 10^(-4) (m3 m-2 s-1). beta positive value representing power equation calculate Fd. Default 1.231. do_heartwood_correction boolean. `TRUE`, heartwood correction applied correct dT calculating Fd; else, correction applied. Default `FALSE`. ratio_conductive number 0 1, indicating ratio probe length sapwood width. parameter must provided `do_heartwood_correction` `TRUE`. Default `NULL`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_fd.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate sap flux density time series — calc_fd","text":"vector Fd (m3 m-2 s-1). length vector matches  input dT dTmax vectors.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_fd.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Calculate sap flux density time series — calc_fd","text":"Fd estimated using power-type function introduced Granier  (1985; Annales des Sciences Forestieres, 1987; Tree Physiology). First,  dimensionless index K obtained dT dTmax. Second, K raised  power `beta` multiplied `alpha`, obtaining Fd. sapwood width shorter probe insertion length, dT can  overestimated, resulting underestimation Fd. Therefore, heartwood  correction required correct dT. Optionally, calculating Fd, dT  can replaced corrected dT specifying ratio probe  length sapwood width. correction assumes dT measured  part probe inserted heartwood always dTmax.  See details Clearwater et al. (1999; Tree Physiology).","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_fd.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate sap flux density time series — calc_fd","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_fd.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate sap flux density time series — calc_fd","text":"","code":"## Load data data(dt_gf) data(dtmax) dt <- dt_gf$dt dtmax <- dtmax$dtmax_sp  ## Calculate sap flux density result <- calc_fd(vctr_dt = dt, vctr_dtmax = dtmax)"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_ref_stats.html","id":null,"dir":"Reference","previous_headings":"","what":"Define reference values of average and standard deviation — calc_ref_stats","title":"Define reference values of average and standard deviation — calc_ref_stats","text":"`calc_ref_stats()` determines reference values average  standard deviation entire period calculating median  statistical values first several days sub-period.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_ref_stats.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Define reference values of average and standard deviation — calc_ref_stats","text":"","code":"calc_ref_stats(   vctr_time,   vctr_target,   vctr_time_prd_tail = NULL,   wndw_size_ref = 48 * 15,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_ref_stats.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Define reference values of average and standard deviation — calc_ref_stats","text":"vctr_time timestamp vector class POSIXct POSIXt. vctr_target vector targeted time series checked. length time series must `vctr_time`. vctr_time_prd_tail timestamp vector class POSIXct POSIXt, indicating end timings sub-period. Note users must include final timestamp entire time series. instance, users want split entire measurement period three sub-periods, need specify end time stamps first two sub-periods. Default `NULL`. wndw_size_ref positive integer indicating number data points included calculating average standard deviation reference value determination. default 48 * 15, meaning first 15 days sub-period used calculation time interval input timestamp 30 minutes. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_ref_stats.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Define reference values of average and standard deviation — calc_ref_stats","text":"vector two components. first one reference average, second one reference standard deviation. unit values input time series.","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_ref_stats.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Define reference values of average and standard deviation — calc_ref_stats","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_ref_stats.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Define reference values of average and standard deviation — calc_ref_stats","text":"","code":"## Load data data(dt_noisy) time <- dt_noisy$time[11931:12891] target <- dt_noisy$dt[11931:12891] time_prd_tail <- time[148]  ## Calculate reference values of average and standard deviation result <-   calc_ref_stats(vctr_time = time, vctr_target = target,                  vctr_time_prd_tail = time_prd_tail)"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_sw_in_toa.html","id":null,"dir":"Reference","previous_headings":"","what":"Calculate global solar radiation time series at TOA — calc_sw_in_toa","title":"Calculate global solar radiation time series at TOA — calc_sw_in_toa","text":"`calc_sw_in_toa()` obtains incident global solar radiation  time series TOA (top atmosphere) specific location  calculating solar elevation angle estimated equations Campbell  Norman (1998).","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_sw_in_toa.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Calculate global solar radiation time series at TOA — calc_sw_in_toa","text":"","code":"calc_sw_in_toa(   vctr_time,   lat,   lon,   std_meridian,   solar_const = 1365,   sbeta_min = 0.001 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_sw_in_toa.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Calculate global solar radiation time series at TOA — calc_sw_in_toa","text":"vctr_time timestamp vector class POSIXct POSIXt. timestamps must equally spaced arranged chronologically. lat numeric value (degrees) -90 90, indicating latitude specific location. lon numeric value (degrees) -180 180, indicating longitude specific location. std_meridian numeric value (degrees) -180 180, indicating standard meridian specific location. solar_const positive value (W m-2) indicating solar constant. Default 1365 (W m-2). sbeta_min threshold value solar elevation angle (degrees). calculated solar elevation angle less threshold, corresponding global solar radiation becomes zero.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_sw_in_toa.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Calculate global solar radiation time series at TOA — calc_sw_in_toa","text":"vector global solar radiation TOA (W m-2). length vector matches input timestamp vector.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_sw_in_toa.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Calculate global solar radiation time series at TOA — calc_sw_in_toa","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/calc_sw_in_toa.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Calculate global solar radiation time series at TOA — calc_sw_in_toa","text":"","code":"## Make a timestamp vector timezone <- \"Etc/GMT-8\" time <- seq(as.POSIXct(\"2026/01/01\", tz = timezone),  as.POSIXct(\"2026/01/02\", tz = timezone), by = \"30 min\")  ## Obtain global solar radiation at Lambir Hills National Park in Malaysia result <-  calc_sw_in_toa(vctr_time = time, lat = 4.201007, lon = 114.039079,                 std_meridian = 120)"},{"path":"https://yhata86.github.io/fluxfixer/reference/check_absolute_limits.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove outliers by absolute limits — check_absolute_limits","title":"Remove outliers by absolute limits — check_absolute_limits","text":"`check_absolute_limits()` removes --range values  setting lower upper limits.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_absolute_limits.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove outliers by absolute limits — check_absolute_limits","text":"","code":"check_absolute_limits(   vctr_target,   thres_al_min = 3,   thres_al_max = 50,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/check_absolute_limits.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove outliers by absolute limits — check_absolute_limits","text":"vctr_target vector targeted time series checked. thres_al_min threshold value input time series define lower limit. Default 3.0. data points values threshold considered outliers removed. unit threshold must match input time series. thres_al_max threshold value input time series define upper limit. Default 50.0. data points values threshold considered outliers removed. unit threshold must match input time series. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_absolute_limits.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove outliers by absolute limits — check_absolute_limits","text":"vector cleaned time series. length time series input time series. data points values `thres_al_min` `thres_al_max` replaced error label specified `label_err`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_absolute_limits.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Remove outliers by absolute limits — check_absolute_limits","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_absolute_limits.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove outliers by absolute limits — check_absolute_limits","text":"","code":"## Load data data(dt_noisy) target <- dt_noisy$dt  ## Remove out-of-range values result <- check_absolute_limits(vctr_target = target)"},{"path":"https://yhata86.github.io/fluxfixer/reference/check_short_attenuation.html","id":null,"dir":"Reference","previous_headings":"","what":"Detect periods when short-term signal attenuation occurs — check_short_attenuation","title":"Detect periods when short-term signal attenuation occurs — check_short_attenuation","text":"`check_short_attenuation()` detects periods temporary signal  attenuation upward (downward) peak position smoothed  average (standard deviation) time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_short_attenuation.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Detect periods when short-term signal attenuation occurs — check_short_attenuation","text":"","code":"check_short_attenuation(   vctr_time,   vctr_z,   vctr_avg,   vctr_sd,   wndw_size_conv = 48 * 15,   inv_sigma_conv = 0.01,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/check_short_attenuation.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Detect periods when short-term signal attenuation occurs — check_short_attenuation","text":"vctr_time timestamp vector class POSIXct POSIXt. vector indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. vctr_z vector Z-score time series. length vector must match timestamp vector. vctr_avg vector moving window average time series used transforming original time series Z-score time series. length vector must match timestamp vector. unit time series must match `vctr_sd`. vctr_sd vector moving window standard deviation time series used transforming original time series Z-score time series. length vector must match timestamp vector. unit time series must match `vctr_avg`. wndw_size_conv positive integer indicating number data points included moving window. THeefault 48 * 15, meaning window size 15 days time interval input timestamp 30 minutes. inv_sigma_conv positive value defining Gaussian window width. width Gaussian window inversely proportional parameter. Default 0.01. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_short_attenuation.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Detect periods when short-term signal attenuation occurs — check_short_attenuation","text":"data frame columns : * first column, `time_start`, gives timestamp detected  attenuation period begins. * second column, `time_peak`, gives timestamp detected  attenuation period peak. * third column, `time_end`, gives timestamp detected  attenuation period ends. * fourth column, `ratio`, gives average ratio standard  deviation detected attenuation peak beginning end  attenuation period. value can used threshold  determining final attenuation periods require Z-score modification.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_short_attenuation.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Detect periods when short-term signal attenuation occurs — check_short_attenuation","text":"cases, dT time series may yield signal attenuated short period, example, rainfall continues days, causing moving window mean (standard deviation) increase (decrease). cases, normalization cause Z-score time series immediately rainfall unnaturally distorted, hindering construction random-forest model. function can detect periods moving window average upward peak, moving window standard deviation downward peak simultaneously. First, average standard deviation time series interpolated contain missing values. Second, smoothed convolution Gaussian window specified user parameters `wndw_size_conv` `inv_sigma_conv`. Third, first-order second-order differences smoothed time series calculated, determine upward peak positions average downward peak positions standard deviation. Finally, possible signal attenuation periods output. start end periods defined timings first-order differenced standard deviation time series changes sign peak.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/check_short_attenuation.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Detect periods when short-term signal attenuation occurs — check_short_attenuation","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_gf.html","id":null,"dir":"Reference","previous_headings":"","what":"Quality-controlled and gap-filled dT time series — dt_gf","title":"Quality-controlled and gap-filled dT time series — dt_gf","text":"Dataset consisting time series quality-controlled gap-filled dT (temperature difference thermal dissipation sap flow probes), meteorological factors, soil water content Lambir Hills National Park, Malaysia.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_gf.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Quality-controlled and gap-filled dT time series — dt_gf","text":"","code":"data(dt_gf)"},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_gf.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Quality-controlled and gap-filled dT time series — dt_gf","text":"data frame 17520 rows 8 variables: time Timestamp measurement end timing dt Quality-controlled gap-filled dT (degrees Celsius) p Precipitation (mm) sw_in Global solar radiation (W m-2) ta Air temperature (degrees Celsius) vpd Vapor pressure deficit (hPa) ws Horizontal wind speed (m s-1) swc Soil water content (m3 m-3)","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_gf.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Quality-controlled and gap-filled dT time series — dt_gf","text":"Meteorological factors soil water content data provided  Dr. Tomonori Kume [ORCiD: 0000-0001-6569-139X]","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_noisy.html","id":null,"dir":"Reference","previous_headings":"","what":"Raw dT time series with various artifacts — dt_noisy","title":"Raw dT time series with various artifacts — dt_noisy","text":"Dataset consisting time series raw dT (temperature difference thermal dissipation sap flow probes), meteorological factors, soil water content Lambir Hills National Park, Malaysia. Missing values represented -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_noisy.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Raw dT time series with various artifacts — dt_noisy","text":"","code":"data(dt_noisy)"},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_noisy.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"Raw dT time series with various artifacts — dt_noisy","text":"data frame 17520 rows 8 variables: time Timestamp measurement end timing dt Raw dT (degrees Celsius) p Precipitation (mm) sw_in Global solar radiation (W m-2) ta Air temperature (degrees Celsius) vpd Vapor pressure deficit (hPa) ws Horizontal wind speed (m s-1) swc Soil water content (m3 m-3)","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dt_noisy.html","id":"source","dir":"Reference","previous_headings":"","what":"Source","title":"Raw dT time series with various artifacts — dt_noisy","text":"Meteorological factors soil water content data provided  Dr. Tomonori Kume [ORCiD: 0000-0001-6569-139X]","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dtmax.html","id":null,"dir":"Reference","previous_headings":"","what":"dTmax time series estimated by multiple methods — dtmax","title":"dTmax time series estimated by multiple methods — dtmax","text":"Dataset consisting time series dTmax (maximum temperature difference thermal dissipation sap flow probes zero-flow conditions) calculated successive predawn (SP), daily predawn (PD), moving window (MW), double regression (DR), environmental dependent (ED) methods.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/dtmax.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"dTmax time series estimated by multiple methods — dtmax","text":"","code":"data(dtmax)"},{"path":"https://yhata86.github.io/fluxfixer/reference/dtmax.html","id":"format","dir":"Reference","previous_headings":"","what":"Format","title":"dTmax time series estimated by multiple methods — dtmax","text":"data frame 17520 rows 6 variables: time Timestamp measurement end timing dtmax_sp dTmax estimated SP method (degrees Celsius) dtmax_pd dTmax estimated PD method (degrees Celsius) dtmax_mw dTmax estimated MW method (degrees Celsius) dtmax_dr dTmax estimated DR method (degrees Celsius) dtmax_ed dTmax estimated ED method (degrees Celsius)","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/fill_gaps.html","id":null,"dir":"Reference","previous_headings":"","what":"Fill missing values with a random forest model — fill_gaps","title":"Fill missing values with a random forest model — fill_gaps","text":"`fill_gaps()` replaces missing values target time  series values estimated random forest model whose hyperparameters  calibrated using grid search approach --bag evaluation.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/fill_gaps.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Fill missing values with a random forest model — fill_gaps","text":"","code":"fill_gaps(   df,   colname_label,   vctr_colname_feature = NULL,   vctr_min_nodesize = c(5),   vctr_m_try = NULL,   vctr_subsample_gf = c(1),   frac_train = 0.75,   n_tree = 500,   ran_seed = 12345,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/fill_gaps.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Fill missing values with a random forest model — fill_gaps","text":"df data frame including label (explained variable) feature (explanatory variables) time series model input. acceptable include missing values column. colname_label character representing name column label time series. vctr_colname_feature vector characters indicating name feature time series columns used constructing random forest model. `NULL` (default), columns excluding label column specified `colname_label` input data frame used feature columns. vctr_min_nodesize vector positive integers indicating candidates hyperparameter random forest model, defining minimal node size (minimum number data points included leaf node). Default `c(5)`. vctr_m_try vector positive integers indicating candidates hyperparameter random forest model, defining number features used splitting node. `NULL` (default), integers two number feature variables tested. vctr_subsample_gf vector numerical values 0 1, indicating candidates hyperparameter random forest model, defining fraction input training data points sampled constructing random forest. Default `c(1)`. frac_train numerical value 0 1, defining fraction data points categorized training data random forest model construction. data points classified test data. Default 0.75. n_tree integer representing number trees random forest. Default 500. ran_seed integer representing random seed random forest model construction. Default 12345. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/fill_gaps.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Fill missing values with a random forest model — fill_gaps","text":"list two elements. first element `mse` mean squared error predicted original values test data set. second element `stats` data frame columns : * first column, `gapfilled`, gives gap-filled time series,  missing values replaced predicted values random  forest model. * second column, `avg_predicted`, gives ensemble mean time series  calculated estimated values time point tree  constructed random forest. * third column, `sd_predicted`, gives ensemble mean time series  calculated estimated values time point tree  constructed random forest.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/fill_gaps.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Fill missing values with a random forest model — fill_gaps","text":"random forest model constructed targeted time series fill missing values. time series assumed stationary, detrending needed inputting trend. Users can input feature dataset, --bag evaluation used determine hyperparameters. evaluation applied training dataset separated entire input data. reduce computational cost, hyperparameter used default grid search number candidate features. determining optimal hyperparameters, used construct optimal random forest model. Predicted time series equal average 500 (default) tree outputs time point. input targeted value missing, predicted value used imputation.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/fill_gaps.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Fill missing values with a random forest model — fill_gaps","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/fill_gaps.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Fill missing values with a random forest model — fill_gaps","text":"","code":"## Load data data(dt_noisy) df_raw <- dt_noisy[c(13105:14112), ]  ## Remove error values for making data gaps df_raw$dt <- ifelse(df_raw$dt > 9.5, df_raw$dt, -9999)  ## Fill data gaps result <-   fill_gaps(df = df_raw, colname_label = \"dt\",             vctr_colname_feature = c(\"sw_in\", \"vpd\", \"swc\", \"ta\"))$stats #> Random forest-based gap-filling started #> --- Hyperparameter optimization using grid search started #> --- MSE: Mean square error for out-of-bag data #> --- Hyperparameter set: [m_try, min_nodesize, subsample] #> --- MSE: 0.0676186047, Hyperparameter set: [2, 5, 1] #> --- MSE: 0.06559005, Hyperparameter set: [3, 5, 1] #> --- MSE: 0.0665401028, Hyperparameter set: [4, 5, 1] #> --- Optimal hyperparameter set: [3, 5, 1] #> --- Hyperparameter optimization using grid search finished #> --- Random forest construction started #> --- Random forest construction finished #> Random forest-based gap-filling finished"},{"path":"https://yhata86.github.io/fluxfixer/reference/filter_highfreq_noise.html","id":null,"dir":"Reference","previous_headings":"","what":"Filter high frequency noise by Gaussian filter — filter_highfreq_noise","title":"Filter high frequency noise by Gaussian filter — filter_highfreq_noise","text":"`filter_highfreq_noise()` filters time series specific  period convolving Gaussian window, removing high-frequency  noise.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/filter_highfreq_noise.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Filter high frequency noise by Gaussian filter — filter_highfreq_noise","text":"","code":"filter_highfreq_noise(   vctr_time,   vctr_target,   vctr_time_noise,   wndw_size_noise = 13,   inv_sigma_noise = 0.01,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/filter_highfreq_noise.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Filter high frequency noise by Gaussian filter — filter_highfreq_noise","text":"vctr_time timestamp vector class POSIXct POSIXt. timestamps must equally spaced arranged chronologically. vctr_target vector targeted time series checked. length time series must `vctr_time`. vctr_time_noise timestamp vector class POSIXct POSIXt, indicating high-frequency noise exists targeted time series. wndw_size_noise positive integer indicating number data points included moving Gaussian window high-frequency noise filtering. default 13, meaning window size 6.5 hours time interval input timestamp 30 minutes. inv_sigma_noise positive value defining Gaussian window width high-frequency noise filtering. width Gaussian window inversely proportional parameter. Default 0.01. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/filter_highfreq_noise.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Filter high frequency noise by Gaussian filter — filter_highfreq_noise","text":"vector noise-filtered time series. length time series input time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/filter_highfreq_noise.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Filter high frequency noise by Gaussian filter — filter_highfreq_noise","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/filter_highfreq_noise.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Filter high frequency noise by Gaussian filter — filter_highfreq_noise","text":"","code":"## Create data time <- seq(as.POSIXct(\"2026/01/01\"), length.out = 360, by = \"1 day\") x <- seq(1, 360) target <- sin(x / 180 * pi) + stats::rnorm(length(x), sd = 0.2) time_noise <-   seq(as.POSIXct(\"2026/01/01\"), as.POSIXct(\"2026/09/01\"), by = \"1 day\")  ## Filter noise result <-   filter_highfreq_noise(vctr_time = time, vctr_target = target,                         vctr_time_noise = time_noise)"},{"path":"https://yhata86.github.io/fluxfixer/reference/fluxfixer-package.html","id":null,"dir":"Reference","previous_headings":"","what":"fluxfixer: Advanced Framework for Sap Flow Data Post-Process — fluxfixer-package","title":"fluxfixer: Advanced Framework for Sap Flow Data Post-Process — fluxfixer-package","text":"Provides flexible framework post-processing thermal dissipation sap flow data using statistical methods machine learning. framework includes anomaly correction, outlier removal, gap-filling, trend removal, signal damping correction, sap flux density calculation. functions package can also apply time series various artifacts.","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/fluxfixer-package.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"fluxfixer: Advanced Framework for Sap Flow Data Post-Process — fluxfixer-package","text":"Maintainer: Yoshiaki Hata yoshiakihata0806@gmail.com (ORCID) [copyright holder]","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/get_interval.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain time interval of input timestamp vector — get_interval","title":"Obtain time interval of input timestamp vector — get_interval","text":"`get_interval()` retrieves time interval input  timestamp vector checks whether format time vector  acceptable successive process.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/get_interval.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain time interval of input timestamp vector — get_interval","text":"","code":"get_interval(vctr_time)"},{"path":"https://yhata86.github.io/fluxfixer/reference/get_interval.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain time interval of input timestamp vector — get_interval","text":"vctr_time timestamp vector class POSIXct POSIXt. timestamps must equally spaced arranged chronologically.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/get_interval.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain time interval of input timestamp vector — get_interval","text":"numeric (minutes) indicating time interval input timestamp  vector.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/get_interval.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Obtain time interval of input timestamp vector — get_interval","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/modify_short_drift.html","id":null,"dir":"Reference","previous_headings":"","what":"Modify short-term drifts — modify_short_drift","title":"Modify short-term drifts — modify_short_drift","text":"`modify_short_drift()` corrects short-term drifts adjusting   5th 95th percentiles drifted time series   reference time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/modify_short_drift.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Modify short-term drifts — modify_short_drift","text":"","code":"modify_short_drift(   vctr_time,   vctr_target,   vctr_time_drft_head,   vctr_time_drft_tail,   n_day_ref = 3,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/modify_short_drift.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Modify short-term drifts — modify_short_drift","text":"vctr_time timestamp vector class POSIXct POSIXt. timestamps must equally spaced arranged chronologically. vctr_target vector targeted time series checked. length time series must `vctr_time`. vctr_time_drft_head timestamp vector class POSIXct POSIXt, indicating drift starts. vctr_time_drft_tail timestamp vector class POSIXct POSIXt, indicating drift ends. length time series must `vctr_time_drft_head`. n_day_ref positive integer representing number days referenced anomaly period. Default 3 (days). label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/modify_short_drift.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Modify short-term drifts — modify_short_drift","text":"vector drift-corrected time series. length time series input time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/modify_short_drift.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Modify short-term drifts — modify_short_drift","text":"short-term drift correction correct sudden changes average time series short period (hours days) specified `vctr_time_drft_head` `vctr_time_drft_tail`. Multiple short-term drifts can corrected using function.procedure uses reference period, defined consist three days (default) occurrence anomaly. , anomalous time series standardized 5th 95th percentile values anomalous reference (non-anomalous) time series match period. percentile values used instead maximum minimum values ensure robustness possible outliers original reference time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/modify_short_drift.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Modify short-term drifts — modify_short_drift","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/modify_short_drift.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Modify short-term drifts — modify_short_drift","text":"","code":"## Load data data(dt_noisy) time <- dt_noisy$time[11931:12891] target <- dt_noisy$dt[11931:12891] time_drft_head <- time[1] time_drft_tail <- time[148]  ## Correct a short-term drift result <-   modify_short_drift(vctr_time = time, vctr_target = target,                      vctr_time_drft_head = time_drft_head,                      vctr_time_drft_tail = time_drft_tail)"},{"path":"https://yhata86.github.io/fluxfixer/reference/n_valid.html","id":null,"dir":"Reference","previous_headings":"","what":"Obtain the number of data points without missing values — n_valid","title":"Obtain the number of data points without missing values — n_valid","text":"`n_valid()` retrieves number data points without missing   values.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/n_valid.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Obtain the number of data points without missing values — n_valid","text":"","code":"n_valid(vctr, label_err = -9999)"},{"path":"https://yhata86.github.io/fluxfixer/reference/n_valid.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Obtain the number of data points without missing values — n_valid","text":"vctr vector evaluated. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/n_valid.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Obtain the number of data points without missing values — n_valid","text":"integer indicating number input vector elements without  missing values.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/n_valid.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Obtain the number of data points without missing values — n_valid","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/pipe.html","id":null,"dir":"Reference","previous_headings":"","what":"Pipe operator — %>%","title":"Pipe operator — %>%","text":"See magrittr::%>% details.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/pipe.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Pipe operator — %>%","text":"","code":"lhs %>% rhs"},{"path":"https://yhata86.github.io/fluxfixer/reference/pipe.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Pipe operator — %>%","text":"lhs value magrittr placeholder. rhs function call using magrittr semantics.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/pipe.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Pipe operator — %>%","text":"result calling `rhs(lhs)`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_manually.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove error values manually — remove_manually","title":"Remove error values manually — remove_manually","text":"`remove_manually()` removes unreasonable values manually  indicating specific timestamps.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_manually.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove error values manually — remove_manually","text":"","code":"remove_manually(vctr_time, vctr_target, vctr_time_err, label_err = -9999)"},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_manually.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove error values manually — remove_manually","text":"vctr_time timestamp vector class POSIXct POSIXt. vctr_target vector targeted time series checked. length time series must `vctr_time`. vctr_time_err timestamp vector class POSIXct POSIXt, indicating specific error timings. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_manually.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove error values manually — remove_manually","text":"vector cleaned time series. length time series input time series. data points indicated time points `vctr_time_err` replaced error label specified `label_err`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_manually.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Remove error values manually — remove_manually","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_manually.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove error values manually — remove_manually","text":"","code":"## Load data data(dt_noisy) time <- dt_noisy$time[12097:14400] target <- dt_noisy$dt[12097:14400] time_err <- seq(as.POSIXct(\"2013/06/27 18:00\", tz = \"Etc/GMT-8\"),                 as.POSIXct(\"2013/06/27 22:30\", tz = \"Etc/GMT-8\"),                 by = \"30 min\")  ## Remove error values result <-  remove_manually(vctr_time = time, vctr_target = target,                  vctr_time_err = time_err)"},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_rf_outlier.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove outliers detected by a random forest model — remove_rf_outlier","title":"Remove outliers detected by a random forest model — remove_rf_outlier","text":"`remove_rf_outlier()` detects removes outliers random  forest model whose hyperparameters calibrated using grid search  approach --bag evaluation.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_rf_outlier.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove outliers detected by a random forest model — remove_rf_outlier","text":"","code":"remove_rf_outlier(   df,   colname_label,   vctr_colname_feature = NULL,   vctr_min_nodesize = c(5),   vctr_m_try = NULL,   vctr_subsample_outlier = c(0.1),   frac_train = 0.75,   n_tree = 500,   ran_seed = 12345,   coef_iqr = 1.5,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_rf_outlier.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove outliers detected by a random forest model — remove_rf_outlier","text":"df data frame including label (explained variable) feature (explanatory variables) time series model input. acceptable include missing values column. colname_label character representing name column label time series. vctr_colname_feature vector characters indicating name feature time series columns used constructing random forest model. `NULL` (default), columns excluding label column specified `colname_label` input data frame used feature columns. vctr_min_nodesize vector positive integers indicating candidates hyperparameter random forest model, defining minimal node size (minimum number data points included leaf node). Default `c(5)`. vctr_m_try vector positive integers indicating candidates hyperparameter random forest model, defining number features used splitting node. `NULL` (default), integers two number feature variables tested. vctr_subsample_outlier vector numerical values 0 1, indicating candidates hyperparameter random forest model, defining fraction input training data points sampled constructing random forest. Default `c(0.1)`. frac_train numerical value 0 1, defining fraction data points categorized training data random forest model construction. data points classified test data. Default 0.75. n_tree integer representing number trees random forest. Default 500. ran_seed integer representing random seed random forest model construction. Default 12345. coef_iqr positive value defining multiplier interquartile range (IQR). value checked less Q1 (first quartile) - `coef_iqr` * IQR Q3 (third quartile) + `coef_iqr` * IQR, value detected random forest outlier. Default 1.5. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_rf_outlier.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove outliers detected by a random forest model — remove_rf_outlier","text":"list two elements. first element `mse` mean squared error predicted original values test data set. second element `stats` data frame columns : * first column, `cleaned`, gives cleaned time series replacing  detected outliers value specified `label_err`. * second column, `flag_out`, gives flag variable time series  indicating status cleaned time series (0: input data point  originally missing detected outlier; 1: input data  point originally missing detected outlier; 2: input  data point originally missing). * third column, `med`, gives ensemble median time series calculated  estimated values time point tree constructed  random forest. * fourth column, `q1`, gives ensemble Q1 (first quartile) time  series calculated estimated values time point tree  constructed random forest. * fifth column, `q3`, gives ensemble Q3 (third quartile) time series  calculated estimated values time point tree  constructed random forest.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_rf_outlier.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Remove outliers detected by a random forest model — remove_rf_outlier","text":"random forest model constructed targeted time series remove outliers. time series assumed stationary, detrending needed inputting trend. Users can input feature dataset, --bag evaluation used determine hyperparameters. evaluation applied training dataset separated entire input data. reduce computational cost, hyperparameter used default grid search number candidate features. reduce risk learning noise, training data sampling ratio set 0.1 default. determining optimal hyperparameters, used construct optimal random forest model. Output values obtained 500 (default) trees, first quartile (Q1), third quartile (Q3), interquartile range (IQR) output values time point calculated. targeted value less Q1 minus 1.5IQR Q3 plus 1.5IQR (default), data point identified outlier removed.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_rf_outlier.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Remove outliers detected by a random forest model — remove_rf_outlier","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_rf_outlier.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove outliers detected by a random forest model — remove_rf_outlier","text":"","code":"## Load data data(dt_noisy) df_raw <- dt_noisy[c(12097:14400), ]  ## Remove outliers result <-   remove_rf_outlier(df = df_raw, colname_label = \"dt\",                     vctr_colname_feature = c(\"sw_in\", \"vpd\", \"swc\", \"p\"),                     coef_iqr = 3.0)$stats #> Random forest outlier detection started #> --- Hyperparameter optimization using grid search started #> --- MSE: Mean square error for out-of-bag data #> --- Hyperparameter set: [m_try, min_nodesize, subsample] #> --- MSE: 0.6155865213, Hyperparameter set: [2, 5, 0.1] #> --- MSE: 0.6308466906, Hyperparameter set: [3, 5, 0.1] #> --- MSE: 0.6589179693, Hyperparameter set: [4, 5, 0.1] #> --- Optimal hyperparameter set: [2, 5, 0.1] #> --- Hyperparameter optimization using grid search finished #> --- Random forest construction started #> --- Random forest construction finished #> Random forest outlier detection finished"},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_zscore_outlier.html","id":null,"dir":"Reference","previous_headings":"","what":"Remove outliers by Z-score time series — remove_zscore_outlier","title":"Remove outliers by Z-score time series — remove_zscore_outlier","text":"`remove_zscore_outlier()` detects removes outlier values  converting original time series Z-score time series using  moving window.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_zscore_outlier.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Remove outliers by Z-score time series — remove_zscore_outlier","text":"","code":"remove_zscore_outlier(   vctr_time,   vctr_target,   vctr_time_prd_tail = NULL,   wndw_size_z = 48 * 15,   min_n_wndw_z = 5,   thres_z = 5,   n_calc_max = 10,   modify_z = FALSE,   vctr_time_zmod = NULL,   wndw_size_conv = 48 * 15,   inv_sigma_conv = 0.01,   thres_ratio = 0.5,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_zscore_outlier.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Remove outliers by Z-score time series — remove_zscore_outlier","text":"vctr_time timestamp vector class POSIXct POSIXt. vctr_target vector targeted time series checked. length time series must `vctr_time`. vctr_time_prd_tail timestamp vector class POSIXct POSIXt, indicating end timings sub-period. Note users must include final timestamp entire time series. instance, users want split entire measurement period three sub-periods, need specify end time stamps first two sub-periods. Default `NULL`. wndw_size_z positive integer indicating number data points included moving window Z-score outlier removal. default 48 * 15, meaning window size 15 days time interval input timestamp 30 minutes. min_n_wndw_z positive integer indicating minimum number data points calculating statistics using moving window (default 5)  Z-score outlier removal. number data points less threshold, statistics calculated window. thres_z positive threshold value Z-score time series define outliers. Default 5.0. data points Z-scores (absolute values) threshold considered outliers removed. n_calc_max positive integer indicating maximum number Z-score outlier detection iterations. Default 10. modify_z boolean. `TRUE`, conduct Z-score short attenuation correction; else, correction applied. Default `FALSE`. vctr_time_zmod valid `modify_z` `TRUE`. timestamp vector class POSIXct POSIXt, indicating timings short-term signal attenuation correction applied. Default `NULL`. wndw_size_conv valid `modify_z` `TRUE`. positive integer indicating number data points included moving window short-term signal attenuation detection. default 48 * 15, meaning window size 15 days time interval input timestamp 30 minutes. inv_sigma_conv valid `modify_z` `TRUE`. positive value defining Gaussian window width short-term signal attenuation detection. width Gaussian window inversely proportional parameter. Default 0.01. thres_ratio valid `modify_z` `TRUE`. positive threshold value ratio determining whether signal attenuation correction applied detected attenuation period. ratio represents average standard deviation detected attenuation peak relative beginning end attenuation period. ratio threshold value, correction applied. Default 0.5. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_zscore_outlier.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Remove outliers by Z-score time series — remove_zscore_outlier","text":"data frame columns : * first column, `time`, gives timestamp `vctr_time`. * second column, `cleaned`, gives cleaned time series replacing  detected outliers value specified `label_err`. * third column, `z_cleaned`, gives Z-score input time series  removing detected outliers. * fourth column, `avg_cleaned`, gives moving window average  input time series removing detected outliers. * fifth column, `sd_cleaned`, gives moving window standard  deviation input time series removing detected outliers. * sixth column, `flag_out` gives flag variable time series indicating  status cleaned time series (0: input data point  originally missing detected outlier; 1: input data point  originally missing detected outlier; 2: input data  point originally missing).","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_zscore_outlier.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Remove outliers by Z-score time series — remove_zscore_outlier","text":"input time series standardized using moving window, data values converted Z-scores. step, width moving window set 15 days default, centered target time point, standardization performed individually time point time series. threshold Z-score absolute value (default: 5 specified 'thres_z') set, data points outside range removed outliers. outliers removed, Z-score returned original value using original mean standard deviation time series, standardization performed using moving window remove additional outliers. procedures repeated either outliers removed maximum number iterations (default 10) reached. Users can define sub-periods across entire time series using `vctr_time_prd_tail`, Z-score conversion performed sub-period separately. separated conversion useful input time series suddenly changes nature, sensor replacement. cases, sap flow measurements, input dT (temperature difference sap flow probes) time series may yield signal attenuated short period, example, rainfall continues days, causing moving window mean (standard deviation) increase (decrease). cases, standardization  cause Z-score time series immediately rainfall unnaturally distorted, hindering construction random forest model. `modify_z` `TRUE`, outlier removal, function modifies Z-score time series periods moving window average upward peak, moving window standard deviation downward peak simultaneously. First, average standard deviation time series interpolated contain missing values. Second, smoothed convolution user-specified Gaussian window, defined parameters `wndw_size_conv` `inv_sigma_conv`. Third, first-order second-order differences smoothed time series calculated, determine upward peak positions average downward peak positions standard deviation. Fourth, possible signal attenuation periods determined based peak positions. start end periods defined timings first-order differenced standard deviation time series changes sign peak. Fifth, final attenuation periods selected average ratio standard deviation detected attenuation peak beginning end attenuation period threshold value specified `thres_ratio`. Optionally, users can specify periods modified `vctr_time_zmod`. Sixth, average standard deviation time series attenuation periods deleted linearly interpolated. Finally, modified Z-score time series calculated using average standard deviation time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_zscore_outlier.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Remove outliers by Z-score time series — remove_zscore_outlier","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/remove_zscore_outlier.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Remove outliers by Z-score time series — remove_zscore_outlier","text":"","code":"## Load data data(dt_noisy) time <- dt_noisy$time[12097:14400] target <- dt_noisy$dt[12097:14400]  ## Remove outliers result <- remove_zscore_outlier(vctr_time = time, vctr_target = target) #> Z-score outlier detection started #> --- 8 Z-score outliers were detected #> --- 1 Z-score outlier was detected #> --- No Z-score outlier was detected #> Z-score outlier detection finished"},{"path":"https://yhata86.github.io/fluxfixer/reference/retrieve_ts.html","id":null,"dir":"Reference","previous_headings":"","what":"Retrieve time series in its original units — retrieve_ts","title":"Retrieve time series in its original units — retrieve_ts","text":"`retrieve_ts()` converts standardized Z-score time series  time series original units using specific average  standard deviation time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/retrieve_ts.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Retrieve time series in its original units — retrieve_ts","text":"","code":"retrieve_ts(   vctr_target_z,   vctr_target_avg = NA,   vctr_target_sd = NA,   detrend = FALSE,   correct_damping = FALSE,   avg_ref = NULL,   sd_ref = NULL,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/retrieve_ts.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Retrieve time series in its original units — retrieve_ts","text":"vctr_target_z vector Z-score time series converted. Missing values must gap-filled previously. vctr_target_avg vector average time series. Missing values acceptable automatically gap-filled interpolation retrieving process. length vector must match `vctr_target_z`. unit time series must match time series output. Default `NA`. vctr_target_sd vector standard deviation time series. Missing values acceptable automatically gap-filled interpolation retrieving process. length vector must match `vctr_target_z`. unit time series must match time series output. Default `NA`. detrend boolean. `TRUE`, detrending applied reference average specified `avg_ref` used convert Z-score time series time series reference average original units; else, detrending applied, average time series specified `vctr_target_avg` used conversion. Default `FALSE`. correct_damping boolean. `TRUE`, signal damping correction applied reference standard deviation specified `sd_ref` used convert Z-score time series time series original units reference standard deviation; else, correction applied, standard deviation time series specified `vctr_target_sd` used conversion. Default `FALSE`. avg_ref valid `detrend` `TRUE`. numeric value representing reference average. vector reference average time series also acceptable, length vector must match `vctr_target_z`, unit time series must match time series output. Default `NULL`. sd_ref valid `correct_damping` `TRUE`. positive numeric value representing reference standard deviation. vector reference standard deviation time series also acceptable, length vector must match `vctr_target_z`, unit time series must match time series output. Default `NULL`. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/retrieve_ts.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Retrieve time series in its original units — retrieve_ts","text":"vector retrieved time series. length vector `vctr_target_z`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/retrieve_ts.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Retrieve time series in its original units — retrieve_ts","text":"Retrieving time series original units conducted multiplying Z-score standard deviation, followed adding average. average standard deviation time series converting original time series Z-score time series, original values original average standard deviation retrieved. reference values average /standard deviation used, output time series detrended /applied signal damping correction.","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/retrieve_ts.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Retrieve time series in its original units — retrieve_ts","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/retrieve_ts.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Retrieve time series in its original units — retrieve_ts","text":"","code":"## Create data target <- seq(1, 10) target_avg <- rep(mean(target), 10) target_sd <- rep(stats::sd(target), 10) target_z <- (target - target_avg) / target_sd  ## Retrieve time series in its original units result <-   retrieve_ts(vctr_target_z = target_z, vctr_target_avg = target_avg,               vctr_target_sd = target_sd) #> Time series retrieval started #> --- Signal damping correction was not applied #> --- Detrending was not applied #> Time series retrieval finished"},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_fit.html","id":null,"dir":"Reference","previous_headings":"","what":"Tune hyperparameters used in a random forest model — rf_fit","title":"Tune hyperparameters used in a random forest model — rf_fit","text":"`rf_fit()` conducts --bag evaluation  hyperparameters used constructing random forest model using grid  search approach.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_fit.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Tune hyperparameters used in a random forest model — rf_fit","text":"","code":"rf_fit(   df,   colname_label,   vctr_colname_feature = NULL,   vctr_min_nodesize = c(5),   vctr_m_try = NULL,   vctr_subsample = c(0.1),   frac_train = 0.75,   n_tree = 500,   ran_seed = 12345,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_fit.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Tune hyperparameters used in a random forest model — rf_fit","text":"df data frame including label (explained variable) feature (explanatory variables) time series model input. acceptable include missing values column. colname_label character representing name column label time series. vctr_colname_feature vector characters indicating name feature time series columns used constructing random forest model. `NULL` (default), columns excluding label column specified `colname_label` input data frame used feature columns. vctr_min_nodesize vector positive integers indicating candidates hyperparameter random forest model, defining minimal node size (minimum number data points included leaf node). Default `c(5)`. vctr_m_try vector positive integers indicating candidates hyperparameter random forest model, defining number features used splitting node. `NULL` (default), integers two number feature variables tested. vctr_subsample vector numerical values 0 1, indicating candidates hyperparameter random forest model, defining fraction input training data points sampled constructing random forest. Default `c(0.1)`. frac_train numerical value 0 1, defining fraction data points categorized training data random forest model construction. data points classified test data. Default 0.75. n_tree integer representing number trees random forest. Default 500. ran_seed integer representing random seed random forest model construction. Default 12345. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_fit.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Tune hyperparameters used in a random forest model — rf_fit","text":"data frame columns : * first column, `min_nodesize`, gives one `vctr_min_nodesize`  hyperparameter values tested model construction  --bag evaluation. * second column, `m_try`, gives one `vctr_m_try` hyperparameter  values tested model construction --bag evaluation. * third column, `subsample`, gives one `vctr_subsample`  hyperparameter values tested model construction  --bag evaluation. * fourth column, `MSE_OOB`, provides mean squared error  predicted original values --bag data model construction  evaluation.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_fit.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Tune hyperparameters used in a random forest model — rf_fit","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_pred.html","id":null,"dir":"Reference","previous_headings":"","what":"Predict targeted time series by a random forest model — rf_pred","title":"Predict targeted time series by a random forest model — rf_pred","text":"`rf_pred()` constructs random forest model using optimal  hyperparameters previously determined --bag evaluation estimate  targeted time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_pred.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Predict targeted time series by a random forest model — rf_pred","text":"","code":"rf_pred(   df,   colname_label,   vctr_colname_feature = NULL,   min_nodesize,   m_try,   subsample,   do_outlier_detection = TRUE,   frac_train = 0.75,   n_tree = 500,   ran_seed = 12345,   coef_iqr = 1.5,   label_err = -9999 )"},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_pred.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Predict targeted time series by a random forest model — rf_pred","text":"df data frame including label (explained variable) feature (explanatory variables) time series model input. acceptable include missing values column. colname_label character representing name column label time series. vctr_colname_feature vector characters indicating name feature time series columns used constructing random forest model. `NULL` (default), columns excluding label column specified `colname_label` input data frame used feature columns. min_nodesize positive integer indicating minimal node size (minimum number data points included leaf node). hyperparameter previously optimized --bag evaluation. m_try positive integer indicating number features used splitting node. hyperparameter previously optimized --bag evaluation. subsample numerical value 0 1, indicating fraction input training data points sampled constructing random forest. hyperparameter previously optimized --bag evaluation. do_outlier_detection boolean. `TRUE` (default), function predicts time series detect outliers; else, function estimates time series fill gaps. frac_train numerical value 0 1, defining fraction data points categorized training data random forest model construction. data points classified test data. Default 0.75. n_tree integer representing number trees random forest. Default 500. ran_seed integer representing random seed random forest model construction. Default 12345. coef_iqr positive value defining multiplier interquartile range (IQR). value checked less Q1 (first quartile) - `coef_iqr` * IQR Q3 (third quartile) + `coef_iqr` * IQR, value detected random forest outlier. Default 1.5. label_err numeric value representing missing value input vector(s). Default -9999.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_pred.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Predict targeted time series by a random forest model — rf_pred","text":"list two elements. first element `mse` mean squared error predicted original values test data set. second element `stats` data frame, contents differ depending `do_outlier_detection`. `do_outlier_detection` `TRUE`, data frame outputs columns : * first column, `cleaned`, gives cleaned time series replacing  detected outliers value specified `label_err`. * second column, `flag_out`, gives flag variable time series  indicating status cleaned time series (0: input data point  originally missing detected outlier; 1: input data  point originally missing detected outlier; 2: input  data point originally missing). * third column, `med`, gives ensemble median time series calculated  estimated values time point tree constructed  random forest. * fourth column, `q1`, gives ensemble Q1 (first quartile) time  series calculated estimated values time point tree  constructed random forest. * fifth column, `q3`, gives ensemble Q3 (third quartile) time series  calculated estimated values time point tree  constructed random forest. `do_outlier_detection` `FALSE`, data frame outputs columns : * first column, `gapfilled`, gives gap-filled time series,  missing values replaced predicted values random  forest model. * second column, `avg_predicted`, gives ensemble mean time series  calculated estimated values time point tree  constructed random forest. * third column, `sd_predicted`, gives ensemble mean time series  calculated estimated values time point tree  constructed random forest.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/rf_pred.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Predict targeted time series by a random forest model — rf_pred","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/run_fluxfixer.html","id":null,"dir":"Reference","previous_headings":"","what":"Run all quality control processes automatically — run_fluxfixer","title":"Run all quality control processes automatically — run_fluxfixer","text":"`run_fluxfixer()` provides sophisticated protocol  post-processing raw time series, can applied thermal  dissipation sap flow data also noisy time series, using  classic statistical machine-learning methods. sap flow data  processing, users can select multiple methods estimate dTmax ( maximum temperature difference sap flow probes zero-flow  conditions) Fd (sap flux density) time series.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/run_fluxfixer.html","id":"ref-usage","dir":"Reference","previous_headings":"","what":"Usage","title":"Run all quality control processes automatically — run_fluxfixer","text":"","code":"run_fluxfixer(   df,   colname_time,   colname_target,   vctr_time_err = NULL,   label_err = -9999,   thres_al_min = 3,   thres_al_max = 50,   vctr_time_drft_head = NULL,   vctr_time_drft_tail = NULL,   n_day_ref = 3,   vctr_time_noise = NULL,   wndw_size_noise = 13,   inv_sigma_noise = 0.01,   vctr_time_prd_tail = NULL,   wndw_size_z = 48 * 15,   min_n_wndw_z = 5,   thres_z = 5,   n_calc_max = 10,   modify_z = FALSE,   vctr_time_zmod = NULL,   wndw_size_conv = 48 * 15,   inv_sigma_conv = 0.01,   thres_ratio = 0.5,   vctr_colname_feature = NULL,   vctr_min_nodesize = c(5),   vctr_m_try = NULL,   vctr_subsample_outlier = c(0.1),   vctr_subsample_gf = c(1),   frac_train = 0.75,   n_tree = 500,   ran_seed = 12345,   coef_iqr = 1.5,   wndw_size_ref = 48 * 15,   detrend = FALSE,   correct_damping = FALSE,   skip_sapflow_calc = FALSE,   colname_radi = NULL,   colname_ta = NULL,   colname_vpd = NULL,   method = c(\"sp\"),   thres_hour_sp = 5,   thres_radi = 100,   thres_ta = 1,   thres_vpd = 1,   thres_cv = 0.005,   thres_hour_pd = 8,   min_n_wndw_dtmax = 3,   wndw_size_dtmax = 11,   alpha = 1.19 * 10^(-4),   beta = 1.231,   do_heartwood_correction = FALSE,   ratio_conductive = NULL )"},{"path":"https://yhata86.github.io/fluxfixer/reference/run_fluxfixer.html","id":"arguments","dir":"Reference","previous_headings":"","what":"Arguments","title":"Run all quality control processes automatically — run_fluxfixer","text":"df data frame including evenly spaced time stamps local time corresponding raw time series post-processed. thermal dissipation sap flow data, targeted time series must dT (temperature difference sap flow probes) time series. conduct outlier removal gap-filling using random forest model, time series meteorological, soil environment, ecophysiological factors can included. users conduct zero-flow condition estimation, gap-filled time series global solar radiation similar radiative variable (PD, MW, DR, ED methods) air temperature vapor pressure deficit (ED method) must included. colname_time character representing name column input data frame timestamp time series. column indicates timings end measurement local time. interval (typically 15 60 min) allowed, timestamps must equally spaced arranged chronologically. colname_target character representing name column input data frame targeted time series post-processed. thermal dissipation sap flow data, targeted time series must dT (temperature difference sap flow probes) time series. vctr_time_err timestamp vector class POSIXct POSIXt, indicating specific error timings. label_err numeric value representing missing value input vector(s). Default -9999. thres_al_min threshold value input time series define lower limit. Default 3.0. data points values threshold considered outliers removed. unit threshold must match input time series. thres_al_max threshold value input time series define upper limit. Default 50.0. data points values threshold considered outliers removed. unit threshold must match input time series. vctr_time_drft_head timestamp vector class POSIXct POSIXt, indicating drift starts. vctr_time_drft_tail timestamp vector class POSIXct POSIXt, indicating drift ends. length time series must `vctr_time_drft_head`. n_day_ref positive integer representing number days referenced anomaly period. Default 3 (days). vctr_time_noise timestamp vector class POSIXct POSIXt, indicating high-frequency noise exists targeted time series. wndw_size_noise positive integer indicating number data points included moving Gaussian window high-frequency noise filtering. default 13, meaning window size 6.5 hours time interval input timestamp 30 minutes. inv_sigma_noise positive value defining Gaussian window width high-frequency noise filtering. width Gaussian window inversely proportional parameter. Default 0.01. vctr_time_prd_tail timestamp vector class POSIXct POSIXt, indicating end timings sub-period. Note users must include final timestamp entire time series. instance, users want split entire measurement period three sub-periods, need specify end time stamps first two sub-periods. Default `NULL`. wndw_size_z positive integer indicating number data points included moving window Z-score outlier removal. default 48 * 15, meaning window size 15 days time interval input timestamp 30 minutes. min_n_wndw_z positive integer indicating minimum number data points calculating statistics using moving window (default 5)  Z-score outlier removal. number data points less threshold, statistics calculated window. thres_z positive threshold value Z-score time series define outliers. Default 5.0. data points Z-scores (absolute values) threshold considered outliers removed. n_calc_max positive integer indicating maximum number Z-score outlier detection iterations. Default 10. modify_z boolean. `TRUE`, conduct Z-score short attenuation correction; else, correction applied. Default `FALSE`. vctr_time_zmod valid `modify_z` `TRUE`. timestamp vector class POSIXct POSIXt, indicating timings short-term signal attenuation correction applied. Default `NULL`. wndw_size_conv valid `modify_z` `TRUE`. positive integer indicating number data points included moving window short-term signal attenuation detection. default 48 * 15, meaning window size 15 days time interval input timestamp 30 minutes. inv_sigma_conv valid `modify_z` `TRUE`. positive value defining Gaussian window width short-term signal attenuation detection. width Gaussian window inversely proportional parameter. Default 0.01. thres_ratio valid `modify_z` `TRUE`. positive threshold value ratio determining whether signal attenuation correction applied detected attenuation period. ratio represents average standard deviation detected attenuation peak relative beginning end attenuation period. ratio threshold value, correction applied. Default 0.5. vctr_colname_feature vector characters indicating name feature time series columns used constructing random forest model. `NULL` (default), columns excluding label column specified `colname_label` input data frame used feature columns. vctr_min_nodesize vector positive integers indicating candidates hyperparameter random forest model, defining minimal node size (minimum number data points included leaf node). Default `c(5)`. vctr_m_try vector positive integers indicating candidates hyperparameter random forest model, defining number features used splitting node. `NULL` (default), integers two number feature variables tested. vctr_subsample_outlier vector numerical values 0 1, indicating candidates hyperparameter random forest model, defining fraction input training data points sampled constructing random forest. Default `c(0.1)`. vctr_subsample_gf vector numerical values 0 1, indicating candidates hyperparameter random forest model, defining fraction input training data points sampled constructing random forest. Default `c(1)`. frac_train numerical value 0 1, defining fraction data points categorized training data random forest model construction. data points classified test data. Default 0.75. n_tree integer representing number trees random forest. Default 500. ran_seed integer representing random seed random forest model construction. Default 12345. coef_iqr positive value defining multiplier interquartile range (IQR). value checked less Q1 (first quartile) - `coef_iqr` * IQR Q3 (third quartile) + `coef_iqr` * IQR, value detected random forest outlier. Default 1.5. wndw_size_ref positive integer indicating number data points included calculating average standard deviation reference value determination. default 48 * 15, meaning first 15 days sub-period used calculation time interval input timestamp 30 minutes. detrend boolean. `TRUE`, detrending applied reference average used convert Z-score time series time series original units; else, detrending applied, moving window average time series used conversion. Default `FALSE`. correct_damping boolean. `TRUE`, signal damping correction applied, reference standard deviation used convert Z-score time series time series original units; else, correction applied, moving window standard deviation time series used conversion. Default `FALSE`. skip_sapflow_calc boolean. `TRUE`, zero-flow condition estimation sap flux density calculation skipped whole process. setting useful users want post-process time series unrelated sap flow measurements. Default `FALSE`. colname_radi character representing name column input data frame global solar radiation similar radiative variable time series. Default `NULL`, name must provided `method` includes `pd`, `mw`, `dr`, `ed`. Missing values column must gap-filled previously. unit time series must match `thres_radi`. colname_ta character representing name column input data frame air temperature (degrees Celsius) time series. Default `NULL`, name must provided `method` includes `ed`. Missing values must gap-filled previously. unit time series must match `thres_ta`. colname_vpd character representing name column input data frame vapor pressure deficit (VPD, hPa) time series. Default `NULL`, name must provided `method` includes `ed`. Missing values must gap-filled previously. unit time series must match `thres_vpd`. method vector characters indicating dTmax estimation methods. \"sp\", \"pd\", \"mw\", \"dr\", \"ed\" represent successive predawn, daily predawn, moving window, double regression, environmental dependent method, respectively. Default `c(\"sp\")`. thres_hour_sp integer 0 23. threshold hour day defines start predawn local time (default 5). thres_radi threshold value radiation define daytime. Default 100 (W m-2). data points radiation values threshold considered daytime values. unit threshold must match input radiation time series. thres_ta threshold value air temperature define predawn. Default 1.0 (degrees Celsius). dTmax, estimated PD method, air temperature values threshold, selected candidate final dTmax. unit threshold must match input air temperature time series. thres_vpd threshold value VPD define predawn. Default 1.0 (hPa). dTmax, estimated PD method, VPD values threshold, selected candidate final dTmax. unit threshold must match input VPD time series. thres_cv threshold value coefficient variation (CV) define predawn. Default 0.005. dTmax, estimated PD method, CV values threshold, selected candidate final dTmax. thres_hour_pd integer 0 23. threshold hour day defines end predawn local time (default 8). min_n_wndw_dtmax positive integer indicating minimum number data points calculating statistics using moving window (default 3). number data points less threshold, statistics calculated window. wndw_size_dtmax positive integer indicating window size (days) determining moving window maximum values dTmax. Default 11 (days). alpha positive value representing multiplier equation calculate Fd. Default 1.19 * 10^(-4) (m3 m-2 s-1). beta positive value representing power equation calculate Fd. Default 1.231. do_heartwood_correction boolean. `TRUE`, heartwood correction applied correct dT calculating Fd; else, correction applied. Default `FALSE`. ratio_conductive number 0 1, indicating ratio probe length sapwood width. parameter must provided `do_heartwood_correction` `TRUE`. Default `NULL`.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/run_fluxfixer.html","id":"value","dir":"Reference","previous_headings":"","what":"Value","title":"Run all quality control processes automatically — run_fluxfixer","text":"* first column, `time`, gives timestamp input timestamp  specified `colname_time`. * second column, `raw`, gives targeted time series specified  `colname_target`. * third column, `processed`, gives post-processed targeted time  series. * fourth column, `qc`, gives quality-control (QC) flag time series  indicating history modifications data point. flag  originally represented 10-bit binary numbers, converted  decimal output. bit set 1 corresponding  process applied data point. right left, number  represents process initial missing value detection, manual error  value removal, outlier removal absolute limit, short-term drift  correction, high-frequency noise filtering, Z-score outlier removal,  random forest outlier removal, gap-filling, detrending, signal damping  correction. `skip_sapflow_calc` `FALSE`, columns also output. * columns prefix \"dtmax_\" provide dTmax calculated  methods specified `method`. last two letters column name  represent name dTmax estimation method. \"sp\", \"pd\", \"mw\", \"dr\",  \"ed\" represent successive predawn, daily predawn, moving window,  double regression, environmental dependent method, respectively. * columns prefix \"fd_\" provide Fd calculated using  dTmax estimated methods specified `method`. last two  letters column name represent name dTmax estimation  method.","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/run_fluxfixer.html","id":"details","dir":"Reference","previous_headings":"","what":"Details","title":"Run all quality control processes automatically — run_fluxfixer","text":"function executes series quality-control processes input time series. protocol includes absolute limit test, short-term drift correction, high-frequency noise filtering, outlier removal Z-score random forest model, gap-filling using data-driven model, detrending, signal attenuation correction, well zero-flow condition estimation, heartwood correction, sap flux density calculation thermal dissipation sap flow data. See details vignettes: `browseVignettes(\"fluxfixer\")`, step--step function help page. tips helpful users: * users want quality control unrelated sap flow  calculation, set `skip_sapflow_calc` `TRUE`. Estimation zero-flow  condition calculation sap flux density skipped setting. * input time series sudden shifts average /standard  deviation due various reasons, including sensor replacement, specify  end timings events `vctr_time_prd_tail`. Z-score  transformation gets applied sub-period defined timestamps,  calculating reasonable Z-score time series. * processing sap flow data, highly recommended users include  time series vapor pressure deficit input data frame,  typically controls stomatal opening. sap flow measurement  conducted forests high seasonality, deciduous forests,  also recommended include time series amount forest leaf  (leaf area index).","code":""},{"path":[]},{"path":"https://yhata86.github.io/fluxfixer/reference/run_fluxfixer.html","id":"author","dir":"Reference","previous_headings":"","what":"Author","title":"Run all quality control processes automatically — run_fluxfixer","text":"Yoshiaki Hata","code":""},{"path":"https://yhata86.github.io/fluxfixer/reference/run_fluxfixer.html","id":"ref-examples","dir":"Reference","previous_headings":"","what":"Examples","title":"Run all quality control processes automatically — run_fluxfixer","text":"","code":"## Load data data(\"dt_noisy\") df_input <- dt_noisy[c(13105:13920), ]  ## Run all processes automatically result <-   run_fluxfixer(df = df_input, colname_time = \"time\", colname_target = \"dt\",                 vctr_colname_feature = c(\"sw_in\", \"vpd\", \"swc\"),                 skip_sapflow_calc = TRUE) #> *** Fluxfixer started running *** #> Manual error value removal was not applied #> Absolute limits test finished #> Short-term drift correction was not applied #> High frequency noise filtering was not applied #> Z-score outlier detection started #> --- No Z-score outlier was detected #> Z-score outlier detection finished #> Random forest outlier detection started #> --- Hyperparameter optimization using grid search started #> --- MSE: Mean square error for out-of-bag data #> --- Hyperparameter set: [m_try, min_nodesize, subsample] #> --- MSE: 0.0559425237, Hyperparameter set: [2, 5, 0.1] #> --- MSE: 0.0565652451, Hyperparameter set: [3, 5, 0.1] #> --- Optimal hyperparameter set: [2, 5, 0.1] #> --- Hyperparameter optimization using grid search finished #> --- Random forest construction started #> --- Random forest construction finished #> Random forest outlier detection finished #> Reference value definition was not applied #> Random forest-based gap-filling started #> --- Hyperparameter optimization using grid search started #> --- MSE: Mean square error for out-of-bag data #> --- Hyperparameter set: [m_try, min_nodesize, subsample] #> --- MSE: 0.0256471796, Hyperparameter set: [2, 5, 1] #> --- MSE: 0.0275280593, Hyperparameter set: [3, 5, 1] #> --- Optimal hyperparameter set: [2, 5, 1] #> --- Hyperparameter optimization using grid search finished #> --- Random forest construction started #> --- Random forest construction finished #> Random forest-based gap-filling finished #> Time series retrieval started #> --- Signal damping correction was not applied #> --- Detrending was not applied #> Time series retrieval finished #> Quality-control flag determination finished #> dTmax and Fd calculation processes skipped"},{"path":"https://yhata86.github.io/fluxfixer/news/index.html","id":"fluxfixer-100","dir":"Changelog","previous_headings":"","what":"fluxfixer 1.0.0","title":"fluxfixer 1.0.0","text":"First CRAN release","code":""}]
