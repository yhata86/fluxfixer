<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate sap flux density time series — calc_fd • fluxfixer</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate sap flux density time series — calc_fd"><meta name="description" content="`calc_fd()` calculates Fd (sap flux density) time series by a
 power-type function, including heartwood correction."><meta property="og:description" content="`calc_fd()` calculates Fd (sap flux density) time series by a
 power-type function, including heartwood correction."><meta property="og:image" content="https://yhata86.github.io/fluxfixer/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fluxfixer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/fluxfixer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yhata86/fluxfixer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate sap flux density time series</h1>
      <small class="dont-index">Source: <a href="https://github.com/yhata86/fluxfixer/blob/v1.0.0/R/calc_fd.R" class="external-link"><code>R/calc_fd.R</code></a></small>
      <div class="d-none name"><code>calc_fd.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`calc_fd()` calculates Fd (sap flux density) time series by a
 power-type function, including heartwood correction.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_fd</span><span class="op">(</span></span>
<span>  <span class="va">vctr_dt</span>,</span>
<span>  <span class="va">vctr_dtmax</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">1.19</span> <span class="op">*</span> <span class="fl">10</span><span class="op">^</span><span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">1.231</span>,</span>
<span>  do_heartwood_correction <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  ratio_conductive <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vctr-dt">vctr_dt<a class="anchor" aria-label="anchor" href="#arg-vctr-dt"></a></dt>
<dd><p>A vector of dT (the temperature difference between sap flow
probes, in degrees Celsius) time series. The length of the vector must
match that of the timestamp vector. Missing values must be gap-filled
previously.</p></dd>


<dt id="arg-vctr-dtmax">vctr_dtmax<a class="anchor" aria-label="anchor" href="#arg-vctr-dtmax"></a></dt>
<dd><p>A vector of dTmax (the maximum temperature difference
between sap flow probes under zero-flow conditions, in degrees Celsius)
time series. The length of the vector must match that of `vctr_dt`. Missing
values must be gap-filled previously.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>A positive value representing a multiplier in the equation to
calculate Fd. Default is 1.19 * 10^(-4) (m3 m-2 s-1).</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>A positive value representing a power in the equation to
calculate Fd. Default is 1.231.</p></dd>


<dt id="arg-do-heartwood-correction">do_heartwood_correction<a class="anchor" aria-label="anchor" href="#arg-do-heartwood-correction"></a></dt>
<dd><p>A boolean. If `TRUE`, the heartwood
correction is applied to correct dT before calculating Fd; else, the
correction is not applied. Default is `FALSE`.</p></dd>


<dt id="arg-ratio-conductive">ratio_conductive<a class="anchor" aria-label="anchor" href="#arg-ratio-conductive"></a></dt>
<dd><p>A number between 0 and 1, indicating the ratio of
the probe length to sapwood width. This parameter must be provided if
`do_heartwood_correction` is `TRUE`. Default is `NULL`.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of Fd (m3 m-2 s-1). The length of the vector matches that of the
 input dT and dTmax vectors.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Fd is estimated using a power-type function introduced by Granier
 (1985; Annales des Sciences Forestieres, 1987; Tree Physiology). First, a
 dimensionless index K is obtained from dT and dTmax. Second, K is raised to
 the power `beta` and then multiplied by `alpha`, obtaining Fd.</p>
<p>If the sapwood width is shorter than the probe insertion length, dT can be
 overestimated, resulting in an underestimation of Fd. Therefore, heartwood
 correction is required to correct dT. Optionally, before calculating Fd, dT
 can be replaced with the corrected dT by specifying the ratio of the probe
 length to sapwood width. This correction assumes that the dT measured by
 the part of the probe that is inserted into the heartwood is always dTmax.
 See more details in Clearwater et al. (1999; Tree Physiology).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yoshiaki Hata</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dt_gf</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dtmax</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">dt</span> <span class="op">&lt;-</span> <span class="va">dt_gf</span><span class="op">$</span><span class="va">dt</span></span></span>
<span class="r-in"><span><span class="va">dtmax</span> <span class="op">&lt;-</span> <span class="va">dtmax</span><span class="op">$</span><span class="va">dtmax_sp</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Calculate sap flux density</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu">calc_fd</span><span class="op">(</span>vctr_dt <span class="op">=</span> <span class="va">dt</span>, vctr_dtmax <span class="op">=</span> <span class="va">dtmax</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yoshiaki Hata.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

