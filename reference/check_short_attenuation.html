<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Detect periods when short-term signal attenuation occurs — check_short_attenuation • fluxfixer</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Detect periods when short-term signal attenuation occurs — check_short_attenuation"><meta name="description" content="`check_short_attenuation()` detects periods of temporary signal
 attenuation by the upward (or downward) peak position of the smoothed
 average (or standard deviation) time series."><meta property="og:description" content="`check_short_attenuation()` detects periods of temporary signal
 attenuation by the upward (or downward) peak position of the smoothed
 average (or standard deviation) time series."><meta property="og:image" content="https://yhata86.github.io/fluxfixer/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fluxfixer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/fluxfixer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yhata86/fluxfixer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Detect periods when short-term signal attenuation occurs</h1>
      <small class="dont-index">Source: <a href="https://github.com/yhata86/fluxfixer/blob/v1.0.0/R/utils.R" class="external-link"><code>R/utils.R</code></a></small>
      <div class="d-none name"><code>check_short_attenuation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`check_short_attenuation()` detects periods of temporary signal
 attenuation by the upward (or downward) peak position of the smoothed
 average (or standard deviation) time series.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">check_short_attenuation</span><span class="op">(</span></span>
<span>  <span class="va">vctr_time</span>,</span>
<span>  <span class="va">vctr_z</span>,</span>
<span>  <span class="va">vctr_avg</span>,</span>
<span>  <span class="va">vctr_sd</span>,</span>
<span>  wndw_size_conv <span class="op">=</span> <span class="fl">48</span> <span class="op">*</span> <span class="fl">15</span>,</span>
<span>  inv_sigma_conv <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  label_err <span class="op">=</span> <span class="op">-</span><span class="fl">9999</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vctr-time">vctr_time<a class="anchor" aria-label="anchor" href="#arg-vctr-time"></a></dt>
<dd><p>A timestamp vector of class POSIXct or POSIXt. This vector
indicates the timings of the end of each measurement in local time. Any
interval (typically 15 to 60 min) is allowed, but the timestamps must be
equally spaced and arranged chronologically.</p></dd>


<dt id="arg-vctr-z">vctr_z<a class="anchor" aria-label="anchor" href="#arg-vctr-z"></a></dt>
<dd><p>A vector of Z-score time series. The length of the vector must
match that of the timestamp vector.</p></dd>


<dt id="arg-vctr-avg">vctr_avg<a class="anchor" aria-label="anchor" href="#arg-vctr-avg"></a></dt>
<dd><p>A vector of moving window average time series that used in
transforming the original time series into the Z-score time series. The
length of the vector must match that of the timestamp vector. The unit of
the time series must match that of `vctr_sd`.</p></dd>


<dt id="arg-vctr-sd">vctr_sd<a class="anchor" aria-label="anchor" href="#arg-vctr-sd"></a></dt>
<dd><p>A vector of moving window standard deviation time series that
used in transforming the original time series into the Z-score time series.
The length of the vector must match that of the timestamp vector. The unit
of the time series must match that of `vctr_avg`.</p></dd>


<dt id="arg-wndw-size-conv">wndw_size_conv<a class="anchor" aria-label="anchor" href="#arg-wndw-size-conv"></a></dt>
<dd><p>A positive integer indicating the number of data
points included in a moving window. THeefault is 48 * 15, meaning that the
window size is 15 days if the time interval of the input timestamp is 30
minutes.</p></dd>


<dt id="arg-inv-sigma-conv">inv_sigma_conv<a class="anchor" aria-label="anchor" href="#arg-inv-sigma-conv"></a></dt>
<dd><p>A positive value defining a Gaussian window width. The
width of the Gaussian window is inversely proportional to this parameter.
Default is 0.01.</p></dd>


<dt id="arg-label-err">label_err<a class="anchor" aria-label="anchor" href="#arg-label-err"></a></dt>
<dd><p>A numeric value representing a missing value in the input
vector(s). Default is -9999.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame with columns below:</p>
<p>* The first column, `time_start`, gives the timestamp at which the detected
 attenuation period begins.</p>
<p>* The second column, `time_peak`, gives the timestamp of the detected
 attenuation period peak.</p>
<p>* The third column, `time_end`, gives the timestamp at which the detected
 attenuation period ends.</p>
<p>* The fourth column, `ratio`, gives the average of the ratio of the standard
 deviation at the detected attenuation peak to that at the beginning and end
 of the attenuation period. This value can be used as a threshold for
 determining the final attenuation periods that require Z-score modification.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>In some cases, the dT time series may yield a signal that is attenuated for
only a short period, for example, when rainfall continues for days, causing
the moving window mean (or standard deviation) to increase (or decrease).
In such cases, normalization will cause the Z-score time series immediately
before and after the rainfall to be unnaturally distorted, hindering the
construction of the random-forest model. This function can detect periods
when the moving window average has an upward peak, and the moving window
standard deviation has a downward peak simultaneously.</p>
<p>First, the average and standard deviation time series are interpolated if
they contain missing values. Second, they are smoothed by convolution with a
Gaussian window specified by the user through the parameters
`wndw_size_conv` and `inv_sigma_conv`. Third, the first-order and
second-order differences of both smoothed time series are calculated, which
determine the upward peak positions of the average and the downward peak
positions of the standard deviation. Finally, possible signal attenuation
periods are output. The start and end of the periods are defined by the
timings when the first-order differenced standard deviation time series
changes its sign before and after each peak.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yoshiaki Hata</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yoshiaki Hata.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

