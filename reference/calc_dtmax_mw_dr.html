<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Calculate dTmax by the moving window and double regression methods — calc_dtmax_mw_dr • fluxfixer</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Calculate dTmax by the moving window and double regression methods — calc_dtmax_mw_dr"><meta name="description" content="`calc_dtmax_mw_dr()` calculates the time series of dTmax (the
 maximum temperature difference between sap flow probes under zero-flow
 conditions) using the moving window and the double regression methods."><meta property="og:description" content="`calc_dtmax_mw_dr()` calculates the time series of dTmax (the
 maximum temperature difference between sap flow probes under zero-flow
 conditions) using the moving window and the double regression methods."><meta property="og:image" content="https://yhata86.github.io/fluxfixer/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fluxfixer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/fluxfixer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yhata86/fluxfixer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Calculate dTmax by the moving window and double regression methods</h1>
      <small class="dont-index">Source: <a href="https://github.com/yhata86/fluxfixer/blob/main/R/calc_dtmax.R" class="external-link"><code>R/calc_dtmax.R</code></a></small>
      <div class="d-none name"><code>calc_dtmax_mw_dr.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`calc_dtmax_mw_dr()` calculates the time series of dTmax (the
 maximum temperature difference between sap flow probes under zero-flow
 conditions) using the moving window and the double regression methods.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">calc_dtmax_mw_dr</span><span class="op">(</span></span>
<span>  vctr_time_daily <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vctr_dtmax_pd <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  wndw_size_dtmax <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  min_n_wndw_dtmax <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  output_daily <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  vctr_time <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vctr_dt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  vctr_radi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  thres_radi <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  thres_hour_pd <span class="op">=</span> <span class="fl">8</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vctr-time-daily">vctr_time_daily<a class="anchor" aria-label="anchor" href="#arg-vctr-time-daily"></a></dt>
<dd><p>A timestamp vector of class POSIXct or POSIXt in
daily steps. This vector indicates the start and end dates of the
measurement, and is assumed to be output from the `calc_dtmax_pd()`
function. The timestamps must be equally spaced and arranged
chronologically. If this argument is `NULL` (default), `vctr_time`,
`vctr_dt`, and `vctr_radi` must be provided to conduct the daily predawn
method previously.</p></dd>


<dt id="arg-vctr-dtmax-pd">vctr_dtmax_pd<a class="anchor" aria-label="anchor" href="#arg-vctr-dtmax-pd"></a></dt>
<dd><p>A vector of dTmax estimated by the daily predawn method
in daily steps. This vector is assumed to be output from the
`calc_dtmax_pd()` function. The length of the vector must match that of the
`vctr_time_daily`. If this argument is `NULL` (default), `vctr_time`,
`vctr_dt`, and `vctr_radi` must be provided to conduct the daily predawn
method previously.</p></dd>


<dt id="arg-wndw-size-dtmax">wndw_size_dtmax<a class="anchor" aria-label="anchor" href="#arg-wndw-size-dtmax"></a></dt>
<dd><p>A positive integer indicating the window size (days)
for determining moving window maximum values of dTmax. Default is 11
(days).</p></dd>


<dt id="arg-min-n-wndw-dtmax">min_n_wndw_dtmax<a class="anchor" aria-label="anchor" href="#arg-min-n-wndw-dtmax"></a></dt>
<dd><p>A positive integer indicating the minimum number of
data points for calculating statistics using a moving window (default is
3). If the number of data points is less than this threshold, the
statistics are not calculated in the window.</p></dd>


<dt id="arg-output-daily">output_daily<a class="anchor" aria-label="anchor" href="#arg-output-daily"></a></dt>
<dd><p>A boolean. If `TRUE`, returns dTmax time series in daily
steps; else, returns dTmax in the original time steps. Default is `FALSE`.</p></dd>


<dt id="arg-vctr-time">vctr_time<a class="anchor" aria-label="anchor" href="#arg-vctr-time"></a></dt>
<dd><p>Only valid when `vctr_dtmax_pd` is `NULL`. A timestamp
vector of class POSIXct or POSIXt. This vector indicates the timings of the
end of each measurement in local time. Any interval (typically 15 to 60
min) is allowed, but the timestamps must be equally spaced and arranged
chronologically. Default is `NULL`.</p></dd>


<dt id="arg-vctr-dt">vctr_dt<a class="anchor" aria-label="anchor" href="#arg-vctr-dt"></a></dt>
<dd><p>Only valid when `vctr_dtmax_pd` is `NULL`. A vector of dT
(the temperature difference between sap flow probes, in degrees Celsius)
time series. The length of the vector must match that of the `vctr_time`.
Missing values must be gap-filled previously. Default is `NULL`.</p></dd>


<dt id="arg-vctr-radi">vctr_radi<a class="anchor" aria-label="anchor" href="#arg-vctr-radi"></a></dt>
<dd><p>Only valid when `vctr_dtmax_pd` is `NULL`. A vector of
global solar radiation or a similar radiative variable time series. The
length of the vector must match that of the `vctr_time`. Missing values
must be gap-filled previously. The unit of the time series must match that
of `thres_radi`. Default is `NULL`.</p></dd>


<dt id="arg-thres-radi">thres_radi<a class="anchor" aria-label="anchor" href="#arg-thres-radi"></a></dt>
<dd><p>A threshold value of the radiation to define daytime.
Default is 100 (W m-2). The data points with radiation values above the
threshold are considered daytime values. The unit of the threshold must
match that of the input radiation time series.</p></dd>


<dt id="arg-thres-hour-pd">thres_hour_pd<a class="anchor" aria-label="anchor" href="#arg-thres-hour-pd"></a></dt>
<dd><p>An integer from 0 to 23. The threshold hour of the day
which defines the end of predawn in local time (default is 8).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yoshiaki Hata</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yoshiaki Hata.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

