<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Modify short-term drifts — modify_short_drift • fluxfixer</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Modify short-term drifts — modify_short_drift"><meta name="description" content="`modify_short_drift()` corrects short-term drifts by adjusting
  the 5th and 95th percentiles of the drifted time series to those of
  the reference time series."><meta property="og:description" content="`modify_short_drift()` corrects short-term drifts by adjusting
  the 5th and 95th percentiles of the drifted time series to those of
  the reference time series."><meta property="og:image" content="https://yhata86.github.io/fluxfixer/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">fluxfixer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/fluxfixer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/yhata86/fluxfixer/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Modify short-term drifts</h1>
      <small class="dont-index">Source: <a href="https://github.com/yhata86/fluxfixer/blob/main/R/remove_statistical_outlier.R" class="external-link"><code>R/remove_statistical_outlier.R</code></a></small>
      <div class="d-none name"><code>modify_short_drift.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>`modify_short_drift()` corrects short-term drifts by adjusting
  the 5th and 95th percentiles of the drifted time series to those of
  the reference time series.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">modify_short_drift</span><span class="op">(</span></span>
<span>  <span class="va">vctr_time</span>,</span>
<span>  <span class="va">vctr_target</span>,</span>
<span>  <span class="va">vctr_time_drft_head</span>,</span>
<span>  <span class="va">vctr_time_drft_tail</span>,</span>
<span>  n_day_ref <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  label_err <span class="op">=</span> <span class="op">-</span><span class="fl">9999</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-vctr-time">vctr_time<a class="anchor" aria-label="anchor" href="#arg-vctr-time"></a></dt>
<dd><p>A timestamp vector of class POSIXct or POSIXt. The
timestamps must be equally spaced and arranged chronologically.</p></dd>


<dt id="arg-vctr-target">vctr_target<a class="anchor" aria-label="anchor" href="#arg-vctr-target"></a></dt>
<dd><p>A vector of a targeted time series to be checked. The
length of the time series must be the same as that of `vctr_time`.</p></dd>


<dt id="arg-vctr-time-drft-head">vctr_time_drft_head<a class="anchor" aria-label="anchor" href="#arg-vctr-time-drft-head"></a></dt>
<dd><p>A timestamp vector of class POSIXct or POSIXt,
indicating when each drift starts.</p></dd>


<dt id="arg-vctr-time-drft-tail">vctr_time_drft_tail<a class="anchor" aria-label="anchor" href="#arg-vctr-time-drft-tail"></a></dt>
<dd><p>A timestamp vector of class POSIXct or POSIXt,
indicating when each drift ends. The length of the time series must be the
same as that of `vctr_time_drft_head`.</p></dd>


<dt id="arg-n-day-ref">n_day_ref<a class="anchor" aria-label="anchor" href="#arg-n-day-ref"></a></dt>
<dd><p>A positive integer representing the number of days to be
referenced before and after the anomaly period. Default is 3 (days).</p></dd>


<dt id="arg-label-err">label_err<a class="anchor" aria-label="anchor" href="#arg-label-err"></a></dt>
<dd><p>A numeric value representing a missing value in the input
vector(s). Default is -9999.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A vector of the drift-corrected time series. The length of the time series
is the same as the input time series.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The short-term drift correction is to correct sudden changes in the average
in the time series over a short period (hours to days) specified by
`vctr_time_drft_head` and `vctr_time_drft_tail`. Multiple short-term drifts
can be corrected at once using this function.This procedure uses a reference
period, which is defined to consist of the three days (default) before and
after the occurrence of the anomaly. Then, the anomalous time series is
standardized so that the 5th and 95th percentile values of the anomalous and
reference (non-anomalous) time series match over this period. These
percentile values are used instead of the maximum and minimum values to
ensure robustness against possible outliers in the original or reference
time series.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Yoshiaki Hata</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Load data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dt_noisy</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">time</span> <span class="op">&lt;-</span> <span class="va">dt_noisy</span><span class="op">$</span><span class="va">time</span><span class="op">[</span><span class="fl">11931</span><span class="op">:</span><span class="fl">12891</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">target</span> <span class="op">&lt;-</span> <span class="va">dt_noisy</span><span class="op">$</span><span class="va">dt</span><span class="op">[</span><span class="fl">11931</span><span class="op">:</span><span class="fl">12891</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">time_drft_head</span> <span class="op">&lt;-</span> <span class="va">time</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">time_drft_tail</span> <span class="op">&lt;-</span> <span class="va">time</span><span class="op">[</span><span class="fl">148</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Correct a short-term drift</span></span></span>
<span class="r-in"><span><span class="va">result</span> <span class="op">&lt;-</span></span></span>
<span class="r-in"><span>  <span class="fu">modify_short_drift</span><span class="op">(</span>vctr_time <span class="op">=</span> <span class="va">time</span>, vctr_target <span class="op">=</span> <span class="va">target</span>,</span></span>
<span class="r-in"><span>                     vctr_time_drft_head <span class="op">=</span> <span class="va">time_drft_head</span>,</span></span>
<span class="r-in"><span>                     vctr_time_drft_tail <span class="op">=</span> <span class="va">time_drft_tail</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Yoshiaki Hata.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

